import{q as E,r as N,u as K,j as e,B as P,c as q,a9 as me,y as Q,a as J,aa as xe,ab as A,Y as ge}from"./app-BmJ9-8ba.js";import{T as W,a as Z,b as Y,c as X,d as je,f as we,g as ye}from"./tooltip-3_zJHBHr.js";import{a as R,T as V,b as be,S as ne,P as ve,c as Ne,f as I,d as _e,C as ke,R as Ce,u as G,e as Se,g as Te,h as ee,i as U,j as $e,k as H,l as le,U as re,m as ie,n as ce,r as Pe,s as ze,q as De}from"./TraininMembersFile-DxPtgNYC.js";import{S as oe,a as de,b as pe,c as ue,e as fe,d as Me}from"./select-mkzc42j4.js";import{z as C,I as D,L as z}from"./input-CwNdd4mS.js";import{u as Fe,v as Be}from"./index-DNT3TRw4.js";import{C as Ie}from"./card-CiqlAvGj.js";import{e as te,P as se,u as Ee}from"./index-B8jzc5xN.js";import"./app-BWRYm4UO.js";import"./useQuery-pHrLegI5.js";import"./tiny-invariant-CopsF_GD.js";const Ve=C.object({type:C.string().min(1),description:C.string().min(1),name:C.string().min(1),purpose:C.string().min(1),signup_start:C.coerce.date(),signup_end:C.coerce.date(),training_start:C.coerce.date(),training_end:C.coerce.date(),batch:C.number().min(1),capacity:C.number().min(1),skp:C.number().min(1),jpl:C.number().min(0),cost:C.number().min(1),cp:C.string().min(1),whatsapp_link:C.string().min(1),competences:C.array(C.string().min(1)).nonempty(),target_type:C.array(C.string().min(1)).nonempty()}).superRefine(({signup_start:a,signup_end:r,training_start:b},s)=>{const h=new Date(a),j=new Date(r),i=new Date(b);i<h&&i<j&&s.addIssue({code:"custom",message:"Periode pelatihan tidak boleh kurang dari periode pendaftaran",path:["training_start"]})}),Le=({selectedTypes:a,trainingTypes:r,callback:b})=>{const[s,h]=N.useState(a),j=i=>{h(i),b(i)};return N.useEffect(()=>{a===""||!a||h(a)},[a]),e.jsxs(z,{className:"text-sm font-medium flex flex-col gap-1 col-span-1 max-md:col-span-full",children:["Jenis Pelatihan",e.jsxs(oe,{name:"type",value:s,onValueChange:j,children:[e.jsx(de,{className:"w-full",children:e.jsx(pe,{placeholder:s||"Pilih Jenis Pelatihan","aria-label":s})}),e.jsx(ue,{children:r.map(i=>e.jsx(fe,{value:i,children:i},new Date().getTime()%Math.random()))})]})]})},Ue=({selectedTargets:a,trainingTargets:r,callback:b})=>{const[s,h]=N.useState([]),j=[],[i,p]=N.useState(a||[]);r.map(f=>{j.push({value:f,label:f})});const t=f=>{const o=i.filter(_=>f.some(m=>_.target_type===m)),w=f.filter(_=>!o.some(m=>_===m.target_type)),c=[...o];return w.map(_=>{c.push({target_type:_})}),c},v=f=>{const o=f.map(c=>c.value),w=t(o);console.log(w),h(o),b(o)};return e.jsx(ne,{defaultValue:j.map(f=>i!=null&&i.map(o=>o.target_type).includes(f.value)?f:null).filter(f=>f!==null),isMulti:!0,name:`target_type[${s.length-1>=0?s.length-1:0}]`,options:j,className:"basic-multi-select",classNamePrefix:"select",placeholder:"Target Peserta (Tenaga Medis dll)",onChange:v})},ae=({name:a,className:r,callback:b,presetDate:s})=>{var p,t;const[h,j]=N.useState({from:(s==null?void 0:s.from)||new Date,to:(s==null?void 0:s.to)||R(new Date,2)}),i=v=>{v&&(j(v),b&&(v!=null&&v.to)&&b(v,a))};return e.jsxs("div",{className:q("grid gap-2",r),children:[e.jsxs(ve,{children:[e.jsx(Ne,{asChild:!0,children:e.jsxs(P,{id:"date",variant:"outline",className:q("w-full justify-start text-left font-normal",!h&&"text-muted-foreground"),children:[e.jsx(me,{className:"mr-2 h-4 w-4"}),h!=null&&h.from?h.to?e.jsxs(e.Fragment,{children:[I(h==null?void 0:h.from,"LLL dd, y")," - "," ",I(h==null?void 0:h.to,"LLL dd, y")]}):I(h==null?void 0:h.from,"LLL dd, y"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(_e,{className:"w-auto p-0",align:"start",children:e.jsx(ke,{initialFocus:!0,mode:"range",defaultMonth:h==null?void 0:h.from,selected:h,onSelect:i,numberOfMonths:2})})]}),e.jsx(D,{type:"text",name:`${a}_start`,value:(p=h==null?void 0:h.from)==null?void 0:p.toString(),placeholder:"Periode Pelatihan",hidden:!0,readOnly:!0,className:"hidden"}),e.jsx(D,{type:"text",name:`${a}_end`,value:h.to?(t=h==null?void 0:h.to)==null?void 0:t.toString():"",placeholder:"Periode Pelatihan",hidden:!0,readOnly:!0,className:"hidden"})]})},He=({name:a,callback:r,className:b,value:s,err:h})=>{const[j,i]=N.useState(s??""),p=v=>{i(v.target.value)},t=v=>{v.key==="Enter"&&r&&r(a,v.target.value)};return e.jsxs("div",{className:"flex flex-col gap-1 w-full",children:[e.jsx(D,{type:"text",name:a,className:b,placeholder:"",defaultValue:j,onKeyDown:t,onChange:p}),e.jsx("span",{className:"text-xs text-slate-400",children:"*Tekan Enter untuk Konfirmasi"}),e.jsx("span",{className:"text-sm text-red-500",children:h})]})},Oe=({content:a,handler:r,errors:b})=>{const s="competences",[h,j]=N.useState(a||[]),[i,p]=N.useState(a.length>0?a==null?void 0:a.map(w=>({name:s,value:w.name_competences})):[{name:s,value:""}]),t=(w,c,_)=>{p([...i,{name:w,value:c}])},v=w=>{p(i.filter((c,_)=>_!==w))},f=w=>{const c=h.filter(n=>w.some(d=>n.name_competences===d.value)),_=w.filter(n=>!c.some(d=>n.value===d.name_competences)),m=[...c];return _.map(n=>{m.push({name_competences:n.value})}),m},o=(w,c)=>{const _=w.split("[")[1].replace("]",""),m=i.map((n,d)=>d===Number.parseInt(_)?{...n,value:c}:n);if(p(m),r){const n=f(m);r(n)}};return e.jsx("div",{className:"flex gap-2 justify-center align-middle",children:e.jsxs(z,{className:"flex flex-col gap-1 w-full",children:[e.jsx("span",{className:"text-sm font-bold",children:"Kompetensi"}),i&&i.map((w,c)=>e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsx(He,{name:`${s}[${c}]`,callback:o,className:"w-full",value:w.value,err:b&&b.keys.length>0?b[c]:null}),e.jsx(P,{type:"button",className:"w-fit justify-start text-left font-normal bg-blue-500 fill-white",onClick:()=>t(`${s}`,"",i.length),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M19 11h-6V5h-2v6H5v2h6v6h2v-6h6z"})})}),c>0&&e.jsx(P,{type:"button",className:"w-fit justify-start text-left font-normal bg-red-500 fill-white",onClick:()=>v(c),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M5 11h14v2H5z"})})})]},JSON.stringify(w)+c))]})})},Ae=async(a,r)=>{const b=await J.post(`api/admin/training/phase1/${r}`,a);return console.log(b),b.data};function Re({NextButton:a,training:r,trainingTypes:b,trainingTargets:s}){var y,k;const j=E().props.csrf_token,[i,p]=N.useState(!1),[t,v]=N.useState(r||{name:"",description:"",purpose:"",signup_start:new Date,signup_end:R(new Date,2),training_start:new Date,training_end:R(new Date,2),type:"",batch:0,capacity:0,skp:0,jpl:0,cost:0,cp:"",whatsapp_link:"",competences:[],target_type:[]}),{toast:f}=K(),o=async(g,S)=>{S.event.preventDefault(),g.target_type[0]===""&&(f({title:"Gagal",description:"Target peserta tidak boleh kosong",variant:"destructive",duration:5e3}),S.abort());const T={name:t.name,description:t.description,purpose:t.purpose,signup_start:I(t.signup_start,"yyyy-MM-dd"),signup_end:I(t.signup_end,"yyyy-MM-dd"),training_start:I(t.training_start,"yyyy-MM-dd"),training_end:I(t.training_end,"yyyy-MM-dd"),type:t.type,batch:t.batch,capacity:t.capacity,skp:t.skp,jpl:t.jpl,cost:t.cost,cp:t.cp,whatsapp_link:t.whatsapp_link,competences:t.competences,target_type:t.target_type,_method:"PUT",_csrf:j},$=await Ae(T,r.id);console.log($),$.success?(f({title:"Berhasil",description:$.message,variant:"default",duration:5e3}),p(!0),Q.reload({only:["training"]}),a()):f({title:"Gagal",description:$.message,variant:"destructive",duration:5e3})};let{form:w,errors:c,isSubmitting:_,setFields:m}=Fe({extend:Be({schema:Ve}),onSubmit:o,onError:g=>{console.error(g)}});const n=g=>{v({...t,[g.target.name]:g.target.value})},d=(g,S)=>{if(g!=null&&g.from)switch(v({...t,[`${S}_start`]:g==null?void 0:g.from}),S){case"signup":m("signup_start",g.from);break;case"training":m("training_start",g.from);break}if(g!=null&&g.to)switch(v({...t,[`${S}_end`]:g==null?void 0:g.to}),S){case"signup":m("signup_end",g.to);break;case"training":m("training_end",g.to);break}},l=g=>{console.log(g),v({...t,competences:g})},x=g=>{v({...t,type:g})},u=g=>{v({...t,target_type:g})};return e.jsxs(V,{value:"training",className:"w-full px-3 py-1",children:[e.jsx("h4",{className:"text-lg font-bold",children:"Detail Pelatihan"}),e.jsx("div",{className:"flex flex-col gap-3",children:e.jsxs("form",{ref:w,className:"grid max-md:grid-cols-1 grid-cols-2 gap-4 py-2",children:[e.jsx(D,{type:"text",readOnly:!0,name:"_token",className:"hidden",value:j==null?void 0:j.toString()}),e.jsx(Le,{selectedTypes:t.type,trainingTypes:b,callback:x}),e.jsxs(z,{children:[e.jsx("span",{className:"text-sm font-bold",children:"Nama Pelatihan"}),e.jsx(D,{type:"text",name:"name",placeholder:"Nama Pelatihan",defaultValue:t.name,onChange:n}),e.jsx("span",{className:"text-sm text-red-500",children:c().name})]}),e.jsxs(z,{children:[e.jsx("span",{className:"text-sm font-bold",children:"Deskripsi Pelatihan"}),e.jsx(D,{type:"text",name:"description",placeholder:"Deskripsi Pelatihan",defaultValue:t==null?void 0:t.description,onChange:n}),e.jsx("span",{className:"text-sm text-red-500",children:c().description})]}),e.jsxs(z,{className:"text-sm font-medium flex flex-col gap-1 col-span-1 max-md:col-span-full",children:["Target Peserta",e.jsx(Ue,{selectedTargets:t&&t.target_type,trainingTargets:s,callback:u}),e.jsx("span",{className:"text-sm text-red-500",children:(y=c())==null?void 0:y.target_type})]}),e.jsxs(z,{className:"mb-2",children:[e.jsx("span",{className:"text-sm font-bold",children:"Tujuan Pelatihan"}),e.jsx(be,{name:"purpose",className:"h-full",placeholder:"Tujuan Pelatihan",defaultValue:t&&t.purpose,onChange:n}),e.jsx("span",{className:"text-sm text-red-500",children:c().purpose},new Date().getTime()%Math.random())]}),e.jsx("div",{className:"w-full",children:e.jsx(Oe,{content:t.competences,errors:((k=c())==null?void 0:k.competences)??null,handler:l})}),e.jsxs(z,{children:[e.jsx("span",{className:"text-sm font-bold",children:"Periode Pendaftaran"}),e.jsx(ae,{name:"signup",className:"w-full",presetDate:{from:new Date(t.signup_start),to:new Date(t.signup_end)},callback:d}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm text-red-500",children:c().signup_start}),e.jsx("span",{className:"text-sm text-red-500",children:c().signup_end})]})]}),e.jsxs(z,{children:[e.jsx("span",{className:"text-sm font-bold",children:"Periode Pelatihan"}),e.jsx(ae,{name:"training",className:"w-full",presetDate:{from:new Date(t.training_start),to:new Date(t.training_end)},callback:d}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm text-red-500",children:c().training_start}),e.jsx("span",{className:"text-sm text-red-500",children:c().training_end})]})]}),e.jsxs(z,{children:[e.jsx("span",{className:"text-sm font-bold",children:"Gelombang / Batch"}),e.jsx(D,{type:"number",name:"batch",placeholder:"Gelombang / Batch",defaultValue:t?t.batch:null,onChange:n}),e.jsx("span",{className:"text-sm text-red-500",children:c().batch})]}),e.jsxs(z,{children:[e.jsx("span",{className:"text-sm font-bold",children:"Kuota Pelatihan"}),e.jsx(D,{type:"number",name:"capacity",placeholder:"Kuota Pelatihan",defaultValue:t?t.capacity:null,onChange:n}),e.jsx("span",{className:"text-sm text-red-500",children:c().capacity})]}),e.jsxs(z,{children:[e.jsx("span",{className:"text-sm font-bold",children:"Biaya Pelatihan"}),e.jsx(D,{type:"number",name:"cost",placeholder:"Kuota Pelatihan",defaultValue:t?t.cost:null,onChange:n}),e.jsx("span",{className:"text-sm text-red-500",children:c().cost})]}),e.jsxs(z,{children:[e.jsx("span",{className:"text-sm font-bold",children:"Jumlah SKP"}),e.jsx(D,{type:"number",name:"skp",placeholder:"Jumlah SKP",defaultValue:t?t.skp:null,onChange:n}),e.jsx("span",{className:"text-sm text-red-500",children:c().skp})]}),e.jsxs(z,{children:[e.jsx("span",{className:"text-sm font-bold",children:"Jumlah JPL"}),e.jsx(D,{type:"number",name:"jpl",placeholder:"Jumlah JPL",defaultValue:t?t.jpl:null,onChange:n}),e.jsx("span",{className:"text-sm text-red-500",children:c().jpl})]}),e.jsxs(z,{children:[e.jsx("span",{className:"text-sm font-bold",children:"CP"}),e.jsx(D,{type:"text",name:"cp",placeholder:"CP",defaultValue:t?t.cp:null,onChange:n}),e.jsx("span",{className:"text-sm text-red-500",children:c().cp})]}),e.jsxs(z,{className:"max-md:col-span-1 col-span-full",children:[e.jsx("span",{className:"text-sm font-bold",children:"Link WA (WhatsApp)"}),e.jsx(D,{type:"url",name:"whatsapp_link",placeholder:"Link WA",defaultValue:t?t.whatsapp_link:null,onChange:n}),e.jsx("span",{className:"text-sm text-red-500",children:c().whatsapp_link})]}),e.jsx("div",{className:"col-span-full flex justify-end",children:e.jsx(P,{type:"submit",className:"w-fit justify-start text-left font-normal bg-slate-500 text-white",disabled:_(),children:"Lanjutkan"})})]})})]})}const Ke=async(a,r)=>(await J.post(`/admin/training/${r}/phase2`,a)).data,Je=a=>a.map(b=>({title:b.materi_name,description:b.desc_schedule,start:new Date(b.start_at),end:new Date(b.end_at)}));function Ge({NextButton:a,PrevButton:r,trainingPeriod:b,scheduleData:s,trainingId:h}){var d,l,x,u;const[j,i]=N.useState(s||[]),[p,t]=N.useState(s||[]),[v,f]=N.useState(Je(s)||[]),[o]=N.useState(b||{from:new Date,to:R(new Date,2)}),{toast:w}=K(),c=E().props.csrf_token,_=(y,k)=>{const g=k.filter($=>!y.some(M=>new Date($.start_at)===M.start&&new Date($.end_at)===M.end&&$.desc_schedule===M.description)),S=y.filter($=>!g.some(M=>new Date(M.start_at)===$.start&&new Date(M.end_at)===$.end&&$.description===M.desc_schedule)),T=[...g];return S.map($=>{T.push({start_at:$.start.getTime(),end_at:$.end.getTime(),desc_schedule:$.description||"",materi_name:$.title})}),T},m=y=>{console.log(y);const k=_(y,j);f(y),t(k)},n=async()=>{const k=await Ke({_token:c,_method:"PUT",schedule_content:p},h);k.success?(w({title:"Berhasil",description:k.message,variant:"default",duration:5e3}),a()):w({title:"Gagal",description:k.message,variant:"destructive",duration:5e3})};return e.jsxs(V,{value:"materi",className:"w-full px-3 py-1",children:[e.jsx("h4",{className:"text-lg font-bold",children:"Jadwal dan Materi"}),e.jsxs("span",{className:"text-sm font-bold",children:[(l=(d=o==null?void 0:o.from)==null?void 0:d.toLocaleString().split(" ")[0])==null?void 0:l.replaceAll("-","/")," -"," ",(u=(x=o==null?void 0:o.to)==null?void 0:x.toLocaleString().split(" ")[0])==null?void 0:u.replaceAll("-","/")]}),e.jsx("div",{className:"flex flex-col gap-3",children:e.jsxs("div",{className:"grid max-md:grid-cols-1 grid-cols-2 gap-4 py-2",children:[e.jsx("div",{className:"col-span-full",children:o&&o.from&&o.to?e.jsx(Ce,{minDate:o==null?void 0:o.from,maxDate:o==null?void 0:o.to,obtainSchedule:m,stores:v}):""}),e.jsxs("div",{className:"col-span-full flex justify-between",children:[e.jsx(P,{type:"button",className:"w-fit justify-start text-left font-normal bg-slate-500 text-white",onClick:()=>r(),children:"< Kembali"}),e.jsx(P,{type:"button",className:"w-fit justify-start text-left font-normal bg-slate-500 text-white",onClick:n,children:"Lanjutkan >"})]})]})})]})}const Ze=C.object({content:C.instanceof(File).superRefine((a,r)=>{a.size>2*1024*1024&&r.addIssue({code:C.ZodIssueCode.custom,message:"Ukuran file tidak boleh lebih dari 2MB"}),a.name===""&&r.addIssue({code:C.ZodIssueCode.custom,message:"File tidak boleh kosong"})}),type:C.string().min(1)}),Qe=({name:a,callback:r,className:b,value:s,file_type:h,getErr:j})=>{var d;const[i,p]=N.useState((s==null?void 0:s.content)??new File([],"")),[t,v]=N.useState((s==null?void 0:s.type)??""),[f,o]=N.useState(((d=s==null?void 0:s.content)==null?void 0:d.name)??""),[w,c]=N.useState(null);N.useEffect(()=>{s!=null&&s.content&&(p(s.content),v(s.type),o(s.content.name),m(s.content,s.type))},[s]),N.useEffect(()=>{s!=null&&s.content&&(p(s.content),v(s.type),o(s.content.name),r&&r(a,{content:s.content,type:s.type}),m(s.content,s.type))},[]),N.useEffect(()=>{s!=null&&s.content&&(p(s.content),v(s.type),o(s.content.name),r&&r(a,{content:s.content,type:s.type}),m(i,t))},[i,t]);const _=l=>{if(l.target.files.length===0)return;const x=l.target.files[0];p(x),m(x,t),r&&r(a,{content:x,type:t})},m=(l,x)=>{try{Ze.parse({content:l,type:x}),j(w===null)}catch(u){u instanceof C.ZodError&&(c(u),j(w===null))}},n=l=>{v(l),m(i,l),r&&r(a,{content:i,type:l})};return e.jsx("div",{className:"flex flex-col gap-1 w-full",children:e.jsxs("div",{className:"grid grid-cols-5 max-md:grid-cols-1 gap-1 w-full",children:[e.jsxs(z,{className:"w-full col-span-4",children:[e.jsx("p",{className:"truncate max-w-[75%] text-sm",children:f===""?"Dokumen":f}),e.jsx(D,{type:"file",name:a,id:a,className:xe("w-full",b),"aria-label":f,placeholder:f,accept:"application/pdf",onChange:_}),w&&e.jsx("span",{className:"text-sm text-red-500",children:w.issues.map(l=>l.path.includes("content")?l.message:null)})]}),e.jsxs(z,{className:"w-full col-span-1",children:["Tipe Dokumen",e.jsxs(oe,{name:`${a}_type`,onValueChange:n,value:t,children:[e.jsx(de,{className:"w-full mt-1",children:e.jsx(pe,{placeholder:"Select a fruit"})}),e.jsx(ue,{children:e.jsx(Me,{children:h.map(l=>e.jsx(fe,{value:l,children:l.toUpperCase()},l+Date.now()%Math.random()))})})]}),w&&e.jsx("span",{className:"text-sm text-red-500",children:w.issues.map(l=>l.path.includes("type")?l.message:null)})]})]})})},qe=({content:a,handler:r,file_type:b,getErr:s})=>{const h="file",[j,i]=N.useState((a==null?void 0:a.length)>0?a==null?void 0:a.map(c=>({name:h,value:c})):[{name:h,value:{content:new File([],""),type:""}}]),[,p]=N.useState(0),t=N.useMemo(()=>j,[j]);N.useEffect(()=>{a.length>0&&i(a.map(c=>({name:h,value:c}))),p(c=>c+1)},[a]),N.useEffect(()=>{a.length>0&&i(a.map(c=>({name:h,value:c}))),p(c=>c+1)},[]);const v=(c,_)=>{i([...j,{name:c,value:_}])},f=c=>{i(j.filter((_,m)=>m!==c))},o=(c,_)=>{const m=c.split("[")[1].replace("]",""),n=j.map((d,l)=>l===parseInt(m)?{...d,value:_}:d);i(n),r&&r(n.map(d=>d.value))},w=c=>{s(c)};return e.jsx("div",{className:"flex gap-2 justify-center align-middle mt-2",children:e.jsx("div",{className:"flex flex-col gap-4 w-full",children:j.map((c,_)=>e.jsxs("div",{className:"w-full grid grid-cols-10 gap-2 max-md:grid-cols-5",children:[e.jsx("div",{className:"w-full col-span-8 max-md:col-span-3",children:e.jsx(Qe,{name:`${h}[${_}]`,callback:o,className:"w-full mt-1",value:c.value,file_type:b,getErr:w})}),e.jsxs("div",{className:"col-span-2 w-full h-full flex gap-2 max-md:flex-col justify-center",children:[e.jsx(P,{type:"button",className:"w-full max-md:h-full justify-center text-left font-normal bg-blue-500 fill-white mt-4 max-md:mt-0",onClick:()=>v(`${h}`,{content:new File([],""),type:""}),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M19 11h-6V5h-2v6H5v2h6v6h2v-6h6z"})})}),_>0&&e.jsx(P,{type:"button",className:"w-full max-md:h-full justify-center text-left font-normal bg-red-500 hover:bg-red-600 fill-white mt-4 max-md:mt-0",onClick:()=>f(_),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M5 11h14v2H5z"})})})]})]},JSON.stringify(t[_])+_))})})},We=async(a,r)=>(await J.post(`/api/admin/training/phase3/${r}`,a)).data,Ye=(a,r)=>{let b=[];return a.length!==r.length?!0:(r.map((s,h)=>{var p,t;const j=(p=a.find(v=>v.content.name===s.files))==null?void 0:p.content.name,i=(t=a.find(v=>v.content.name===s.files))==null?void 0:t.type;(j!==s.files||i!==s.type)&&(b[h]=!0)}),b.some(s=>s===!0))};function Xe({file_types:a,NextButton:r,PrevButton:b,fileData:s,trainingId:h}){const[j,i]=N.useState([]),[p,t]=N.useState(s||[]),[v,f]=N.useState(!1);console.log(p);const{toast:o}=K(),w=E().props.csrf_token,c=N.useCallback(l=>{i(l)},[]),{data:_,error:m}=G(p.map(l=>l.url),"docsDataUpdate",p.map(l=>l.files));N.useEffect(()=>{let l="Ada yang salah";console.log(m),m&&(m.message.includes("404")&&(l="Tidak dapat menemukan file yang dibutuhkan"),o({title:"Error",description:l,variant:"destructive",duration:2e3}))},[m]),N.useEffect(()=>{if(!_||_.length<1||m)return;const l=_.map(x=>{const u=p.find(y=>y.files===x.name);if(p.length<=_.length&&u)return{content:x,type:u.type}}).filter(x=>x!==void 0);i(l)},[_]);const n=async()=>{if(!Ye(j,p)&&j.length>0){r();return}const x=new FormData;j.forEach((y,k)=>{Object.keys(y).includes("id")&&x.append(`content[${k}]['id']`,y.id),Object.keys(y).includes("id")||(x.append(`content[${k}]['files']`,y.content),x.append(`content[${k}]['file_type']`,y.type))}),x.append("_token",w),console.log(x);const u=await We(x,h);u.success?(o({title:"Berhasil",description:u.message,variant:"default",duration:5e3}),r()):(o({title:"Gagal",description:u.message,variant:"destructive",duration:5e3}),console.error("Error: ",u.data))},d=l=>{f(l)};return e.jsxs(V,{value:"dokumen",className:"w-full px-3 py-1",children:[e.jsx("h4",{className:"text-lg font-bold",children:"File Pendukung"}),e.jsx("div",{className:"flex flex-col gap-3",children:e.jsx(qe,{content:j,handler:c,file_type:a,getErr:d})}),e.jsxs("div",{className:"col-span-full flex justify-between mt-4",children:[e.jsx(P,{type:"button",className:"w-fit justify-start text-left font-normal bg-slate-500 text-white",onClick:()=>b(),children:"< Kembali"}),e.jsx(P,{type:"button",className:"w-fit justify-start text-left font-normal bg-slate-500 text-white",disabled:!v,onClick:n,children:"Lanjutkan >"})]})]})}const et=({selectedTargets:a,trainingTargets:r,callback:b})=>{const[s,h]=N.useState([]),j=[];r.map(p=>{j.push({value:p.id,label:p.name})});const i=p=>{const t=p.map(f=>f.value),v=r.filter(f=>t.some(o=>o===f.id));h(t),typeof t<"u"&&b(v)};return e.jsx(ne,{value:j.map(p=>(a==null?void 0:a.some(t=>t.id===p.value))&&p),isMulti:!0,name:`organizer[${s.length-1>=0?s.length-1:0}]`,options:j,className:"basic-multi-select",classNamePrefix:"select",placeholder:"Target Peserta (Tenaga Medis dll)",onChange:i})},tt=C.object({content:C.instanceof(File).superRefine((a,r)=>{a.size>2*1024*1024&&r.addIssue({code:C.ZodIssueCode.custom,message:`Ukuran file ${a.name} tidak boleh lebih dari 2MB`}),a.name===""&&r.addIssue({code:C.ZodIssueCode.custom,message:"File tidak boleh kosong"})}),user_id:C.number()}),st=({selected:a,obtainValue:r,storedData:b})=>{const[s,h]=N.useState(null),[j,i]=N.useState([]),p=o=>{if(o.target.files.length===0)return;const w=o.target.files[0],c=o.target.name.split("_"),_=parseInt(c[c.length-1]),m={user_id:_,content:w,type:"spt"};let n=j.filter(d=>d.type!="spt"||d.user_id!=_);f([...n,m]),i([...n,m]),r([...n,m])},t=o=>{if(o.target.files.length===0)return;const w=o.target.files[0],c=o.target.name.split("_"),_=parseInt(c[c.length-1]),m={user_id:_,content:w,type:"sk"};let n=j.filter(d=>d.user_id!=_||d.type!="sk");f([...n,m]),i([...n,m]),r([...n,m])},v=(o,w,c)=>{const _={user_id:o,content:w,type:c};i([...j,_])};N.useEffect(()=>{b.length>0&&i(b)},[b]),N.useEffect(()=>{if(b.length>0)a.map(o=>{const w=[];b.map(c=>{c.user_id==o.id&&w.push(c)}),i(w)});else{const o=[];a.map(w=>{v(w.id,new File([],""),"spt"),v(w.id,new File([],""),"sk")}),i(o)}},[]);const f=o=>{o.map(w=>{try{tt.parse({content:w.content,type:w.type,user_id:w.user_id})}catch(c){c instanceof C.ZodError&&h(c)}})};return e.jsxs(Se,{children:[e.jsx(Te,{children:e.jsxs(ee,{children:[e.jsx(U,{className:"w-fit",children:"No"}),e.jsx(U,{children:"Nama"}),e.jsx(U,{hidden:!0,children:"Download SPT & SPK"}),e.jsx(U,{hidden:!0,className:"text-right",children:"Upload SPT & SPK"})]})}),e.jsx($e,{children:a.map((o,w)=>{var c,_;return e.jsxs(ee,{children:[e.jsx(H,{className:"font-medium",children:w+1}),e.jsx(H,{className:"flex gap-2",children:o.name}),e.jsx(H,{}),e.jsxs(H,{className:"text-right",children:[e.jsxs("div",{className:"flex gap-2",children:[j.find(m=>m.type=="spt"&&m.content.size>0&&m.user_id==o.id)?e.jsx(W,{children:e.jsxs(Z,{children:[e.jsx(Y,{asChild:!0,className:"my-auto",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:`w-6 h-6 ${s?"fill-red-500":""}`,viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"}),e.jsx("path",{d:"M11 11h2v6h-2zm0-4h2v2h-2z"})]})}),e.jsx(X,{className:"bg-white p-2 border-2 border-primary",children:e.jsx("div",{className:"w-full flex justify-center max-h-[52vh] overflow-scroll",children:s?e.jsx("span",{className:"text-sm text-red-500",children:s.issues.map(m=>m.path.includes("content")?m.message:null)}):e.jsx(te,{file:URL.createObjectURL(((c=b.find(m=>o.id==m.user_id&&m.type=="spt"))==null?void 0:c.content)??new File([],"")),className:"mt-2 h-full w-full",children:e.jsx(se,{pageNumber:1,renderTextLayer:!1,renderAnnotationLayer:!1,className:"h-full overflow-hidden rounded shadow-slate-300 shadow-xl"})})})})]})}):"",e.jsxs(P,{className:"bg-blue-500 text-white fill-white mr-1 gap-1",onClick:()=>{var m;return(m=document.getElementById("spt_u_"+o.id))==null?void 0:m.click()},children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M13 19v-4h3l-4-5-4 5h3v4z"}),e.jsx("path",{d:"M7 19h2v-2H7c-1.654 0-3-1.346-3-3 0-1.404 1.199-2.756 2.673-3.015l.581-.102.192-.558C8.149 8.274 9.895 7 12 7c2.757 0 5 2.243 5 5v1h1c1.103 0 2 .897 2 2s-.897 2-2 2h-3v2h3c2.206 0 4-1.794 4-4a4.01 4.01 0 0 0-3.056-3.888C18.507 7.67 15.56 5 12 5 9.244 5 6.85 6.611 5.757 9.15 3.609 9.792 2 11.82 2 14c0 2.757 2.243 5 5 5z"})]}),"Upload SPT"]})]}),e.jsxs("div",{className:"flex gap-2",children:[j.find(m=>m.type==="sk"&&m.content.size>0&&m.user_id==o.id)?e.jsx(W,{children:e.jsxs(Z,{children:[e.jsx(Y,{asChild:!0,className:"my-auto",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:`w-6 h-6 ${s?"fill-red-500":""}`,viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"}),e.jsx("path",{d:"M11 11h2v6h-2zm0-4h2v2h-2z"})]})}),e.jsx(X,{className:"bg-white p-2 border-2 border-primary",children:e.jsx("div",{className:"w-full flex justify-center max-h-[52vh] overflow-scroll",children:s?e.jsx("span",{className:"text-sm text-red-500",children:s.issues.map(m=>m.path.includes("content")?m.message:null)}):e.jsx(te,{file:URL.createObjectURL(((_=b.find(m=>o.id==m.user_id&&m.type=="sk"))==null?void 0:_.content)??new File([],"")),className:"mt-2 h-full w-full",children:e.jsx(se,{pageNumber:1,renderTextLayer:!1,renderAnnotationLayer:!1,className:"h-full overflow-hidden rounded shadow-slate-300 shadow-xl"})})})})]})}):"",e.jsxs(P,{className:"bg-blue-500 text-white fill-white mt-1 gap-1",onClick:()=>{var m;return(m=document.getElementById("sk_u_"+o.id))==null?void 0:m.click()},children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M13 19v-4h3l-4-5-4 5h3v4z"}),e.jsx("path",{d:"M7 19h2v-2H7c-1.654 0-3-1.346-3-3 0-1.404 1.199-2.756 2.673-3.015l.581-.102.192-.558C8.149 8.274 9.895 7 12 7c2.757 0 5 2.243 5 5v1h1c1.103 0 2 .897 2 2s-.897 2-2 2h-3v2h3c2.206 0 4-1.794 4-4a4.01 4.01 0 0 0-3.056-3.888C18.507 7.67 15.56 5 12 5 9.244 5 6.85 6.611 5.757 9.15 3.609 9.792 2 11.82 2 14c0 2.757 2.243 5 5 5z"})]}),"Upload SK"]})]}),e.jsx(D,{type:"file",name:`spt_u_${o.id}`,id:`spt_u_${o.id}`,className:"hidden",accept:"application/pdf",onChange:p}),e.jsx(D,{type:"file",name:`sk_u_${o.id}`,id:`sk_u_${o.id}`,className:"hidden",accept:"application/pdf",onChange:t})]})]},o.username+o.id+new Date().getTime())})})]})},at=async(a,r)=>(await J.post(`/admin/training/${r}/phase4`,a)).data,nt=async(a,r)=>{const b=a.map(async(s,h)=>{const j=await fetch(s);if(!j.ok)throw new Error("Failed to fetch provinces");const i=await j.blob();return new File([i],r[h],{type:i.type})});return Promise.all(b)},lt=(a,r)=>{let b=r.filter(i=>a.some(p=>i.files.some(t=>t.files===p.content.name)));b=b.map(i=>(i.files=i.files.filter(p=>a.some(t=>p.files===t.content.name)),i));const s=a.filter(i=>!b.some(p=>p.files.some(t=>t.files===i.content.name))),h=b.map(i=>{const p=i.files;return s.filter(v=>v.user_id===i.user_id).map(v=>{p.push({files:v.content.name,file_type:v.type,url:URL.createObjectURL(v.content)})}),{id:i.id,user_id:i.user_id,files:p}});return h.some(i=>s.some(p=>i.files.some(t=>t.files===p.content.name)))||s.map(i=>{var p;if(h.some(t=>t.user_id===i.user_id)||h.push({user_id:i.user_id,files:[{files:i.content.name,file_type:i.type,url:URL.createObjectURL(i.content)}]}),h.some(t=>t.user_id===i.user_id)){if((p=h.find(f=>f.user_id===i.user_id))==null?void 0:p.files.some(f=>f.files===i.content.name))return;const v=h.find(f=>f.user_id===i.user_id);v&&v.files.push({files:i.content.name,file_type:i.type,url:URL.createObjectURL(i.content)})}}),h};function rt({organizer:a,organizersData:r,NextButton:b,PrevButton:s,trainingId:h}){const{toast:j}=K(),i=E().props.csrf_token,[p,t]=N.useState(a||[]),[v,f]=N.useState([]),[o,w]=N.useState(r||[]);N.useEffect(()=>{if(r.length<1)return;let l=[];const x=[];r.map(u=>{u.user_id&&x.push(u.user_id)}),a.map(u=>{x.some(y=>y==u.id)&&l.push(u)}),r.map(async u=>{const y=await nt(u.files.map(g=>g.url),u.files.map(g=>g.files));if(!y||(y==null?void 0:y.length)<1)return;const k=y.map((g,S)=>({user_id:u.user_id,content:g,type:u.files[S].file_type}));f(k)}),t(l)},[]);const{data:c,error:_}=G(o.flatMap(l=>l.files.map(x=>x.url)),"docsDataUpdate",o.flatMap(l=>l.files.map(x=>x.files)));N.useEffect(()=>{let l="Ada yang salah";_&&(_.message.includes("404")&&(l="Tidak dapat menemukan file yang dibutuhkan"),j({title:"Error",description:l,variant:"destructive",duration:2e3}))},[_]),N.useEffect(()=>{if(!c||c.length<1)return;const l=c.map(x=>{const u=o.find(k=>k.files.find(g=>g.files===x.name));if(!u)return;const y=x.name.split("_")[1];return{content:x,type:y,user_id:u.user_id}});l.some(x=>!x)||f(l)},[c]);const m=l=>{t(l)},n=async()=>{const l=new FormData,x=[];v.map((y,k)=>{x.some(g=>g===y.user_id)||l.append(`content[${k}][users_id]`,y.user_id),x.some(g=>g===y.user_id)?(l.append(`content[${k-1}][files][${k}]`,y.content),l.append(`content[${k-1}][file_type][${k}]`,y.type)):(l.append(`content[${k}][files][${k}]`,y.content),l.append(`content[${k}][file_type][${k}]`,y.type)),x.push(y.user_id)}),l.append("_token",i),l.append("_method","PUT");const u=await at(l,h);u.success?(j({title:"Berhasil",description:u.message,variant:"default",duration:5e3}),u.data.organizer_data.map((y,k)=>({id:y.users_id,files:y.files.map(S=>({files:S,type:y.file_type[k],url:y.url[k]}))})),Q.reload({only:["organizer","training"]}),b()):(j({title:"Gagal",description:u.message,variant:"destructive",duration:5e3}),console.error("Error: ",u.data))},d=l=>{const x=lt(l,o);console.log(x),f(l)};return e.jsxs(V,{value:"penyelenggara",className:"w-full px-3 py-1",children:[e.jsx("h4",{className:"text-lg font-bold",children:"Penyelenggara"}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(et,{selectedTargets:p,trainingTargets:a,callback:m}),p.length>0&&e.jsx(st,{selected:p,obtainValue:d,storedData:v})]}),e.jsxs("div",{className:"col-span-full flex justify-between mt-2",children:[e.jsx(P,{type:"button",className:"w-fit justify-start text-left font-normal bg-slate-500 text-white",onClick:()=>s(),children:"< Kembali"}),e.jsx(P,{type:"button",className:"w-fit justify-start text-left font-normal bg-slate-500 text-white",onClick:n,children:"Lanjutkan >"})]})]})}function it({facilitator:a,storedData:r,NextButton:b,PrevButton:s,trainingId:h}){const[j,i]=N.useState([]),[p,t]=N.useState([]),v=E().props.csrf_token,{data:f,isLoading:o,error:w}=G(r.flatMap(n=>n.files.map(d=>d.url)),"facsData",r.flatMap(n=>n.files.map(d=>d.files)));N.useEffect(()=>{if(r.length<1)return;let n=[];const d=[];r.map(l=>{d.push(l.id)}),a.map(l=>{d.some(x=>x==l.id)&&n.push(l)}),i(n)},[]),N.useEffect(()=>{if(!f||f.length<1)return;const n=f.map(d=>{const l=r.find(u=>u.files.find(y=>y.files===d.name));if(!l)return;const x=d.name.split("_")[1];return{content:d,type:x,user_id:l.id}});n.some(d=>!d)||t(n)},[f]);const c=n=>{i(n)},_=async()=>{const n=new FormData,d=[];p.map((x,u)=>{d.some(y=>y===x.user_id)||n.append(`content[${u}][users_id]`,x.user_id),d.some(y=>y===x.user_id)?(n.append(`content[${u-1}][files][${u}]`,x.content),n.append(`content[${u-1}][file_type][${u}]`,x.type)):(n.append(`content[${u}][files][${u}]`,x.content),n.append(`content[${u}][file_type][${u}]`,x.type)),d.push(x.user_id)}),n.append("_token",v);const l=await ce(n,5);if(l.success){A({title:"Berhasil",description:l.message,variant:"default",duration:5e3});const x=l.data.facilitator.map((u,y)=>({id:u.users_id,files:u.files.map(g=>({files:g,type:u.file_type[y],url:u.url[y]}))}));obtainData(x),b()}else A({title:"Gagal",description:l.message,variant:"destructive",duration:5e3}),console.error("Error: ",l.data)},m=n=>{t(n)};return e.jsxs(le,{value:"fasilitator",className:"w-full px-3 py-1",children:[e.jsx("h4",{className:"text-lg font-bold",children:"Fasilitator"}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(re,{selectedTargets:j,trainingTargets:a,callback:c}),j.length>0&&e.jsx(ie,{selected:j,obtainValue:m,storedData:p})]}),e.jsxs("div",{className:"col-span-full flex justify-between mt-2",children:[e.jsx(P,{type:"button",className:"w-fit justify-start text-left font-normal bg-slate-500 text-white",onClick:()=>s(),children:"< Kembali"}),e.jsx(P,{type:"button",className:"w-fit justify-start text-left font-normal bg-slate-500 text-white",onClick:_,children:"Lanjutkan >"})]})]})}function ct({controller:a,storedData:r,NextButton:b,PrevButton:s,trainingId:h}){const[j,i]=N.useState([]),[p,t]=N.useState([]),v=E().props.csrf_token,{data:f,isLoading:o,error:w}=G(r.flatMap(n=>n.files.map(d=>d.url)),"contsData",r.flatMap(n=>n.files.map(d=>d.files)));N.useEffect(()=>{if(r.length<1)return;let n=[];const d=[];r.map(l=>{d.push(l.id)}),a.map(l=>{d.some(x=>x==l.id)&&n.push(l)}),i(n)},[]),N.useEffect(()=>{if(!f||f.length<1)return;const n=f.map(d=>{const l=r.find(u=>u.files.find(y=>y.files===d.name));if(!l)return;const x=d.name.split("_")[1];return{content:d,type:x,user_id:l.id}});n.some(d=>!d)||t(n)},[f]);const c=n=>{i(n)},_=async()=>{const n=new FormData,d=[];p.map((x,u)=>{d.some(y=>y===x.user_id)||n.append(`content[${u}][users_id]`,x.user_id),d.some(y=>y===x.user_id)?(n.append(`content[${u-1}][files][${u}]`,x.content),n.append(`content[${u-1}][file_type][${u}]`,x.type)):(n.append(`content[${u}][files][${u}]`,x.content),n.append(`content[${u}][file_type][${u}]`,x.type)),d.push(x.user_id)}),n.append("_token",v);const l=await ce(n,6);if(l.success){A({title:"Berhasil",description:l.message,variant:"default",duration:5e3});const x=l.data.controller.map((u,y)=>({id:u.users_id,files:u.files.map(g=>({files:g,type:u.file_type[y],url:u.url[y]}))}));obtainData(x),b()}else A({title:"Gagal",description:l.message,variant:"destructive",duration:5e3}),console.error("Error: ",l.data)},m=n=>{t(n)};return e.jsxs(le,{value:"pengendali",className:"w-full px-3 py-1",children:[e.jsx("h4",{className:"text-lg font-bold",children:"Pengendali"}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(re,{selectedTargets:j,trainingTargets:a,callback:c}),j.length>0&&e.jsx(ie,{selected:j,obtainValue:m,storedData:p})]}),e.jsxs("div",{className:"col-span-full flex justify-between mt-2",children:[e.jsx(P,{type:"button",className:"w-fit justify-start text-left font-normal bg-slate-500 text-white",onClick:()=>s(),children:"< Kembali"}),e.jsx(P,{type:"button",className:"w-fit justify-start text-left font-normal bg-slate-500 text-white",onClick:_,children:"Lanjutkan >"})]})]})}const ot=C.object({content:C.string().min(1,"Input tidak boleh kosong")}),O=({name:a,callback:r,className:b,value:s,getErr:h})=>{const[j,i]=N.useState(s??""),[p,t]=N.useState(null),v=w=>{o(w.target.value),i(w.target.value)},f=w=>{w.key==="Enter"&&(o(w.target.value),r&&r(a,w.target.value))},o=w=>{try{ot.parse({content:w}),h(p===null)}catch(c){c instanceof C.ZodError&&(t(c),h(p===null))}};return e.jsxs("div",{className:"flex flex-col gap-1 w-full",children:[e.jsx(D,{type:"text",name:a,className:b,placeholder:"",value:j,onKeyDown:f,onChange:v,onClick:w=>o(w.target.value)}),e.jsx("span",{className:"text-xs text-slate-400",children:"*Tekan Enter untuk Konfirmasi"}),p&&e.jsx("span",{className:"text-sm text-red-500",children:p.issues.map(w=>w.path.includes("content")?w.message:null)},p.issues[0].path.includes("content"))]})},dt=({content:a,handler:r,getErr:b,name:s,isRepeater:h=!0,blockButton:j=!1,answer_name:i="text"})=>{const[p,t]=N.useState((a==null?void 0:a.length)>0?a==null?void 0:a.map(({question:n,answer:d},l)=>({name:s,value:n,answer:d})):[{name:s,value:"",answer:""}]),[,v]=N.useState(0),f=N.useMemo(()=>p,[p]),o=Ee("(min-width: 768px)");N.useEffect(()=>{a.length>0&&t(a.map(({question:n,answer:d})=>({name:s,value:n,answer:d}))),v(n=>n+1)},[a]),N.useEffect(()=>{a.length>0&&t(a.map(({question:n,answer:d})=>({name:s,value:item}))),v(n=>n+1)},[]);const w=(n,d)=>{t([...p,{name:n,value:d}])},c=n=>{t(p.filter((d,l)=>l!==n))},_=(n,d)=>{const l=n.split("[")[1].replace("]",""),x=p.map((u,y)=>y===parseInt(l)?{...u,value:d}:u);t(x),r&&r(x.map(u=>u.value))},m=n=>{b(n)};return h?e.jsx("div",{className:"flex gap-2 justify-center align-middle mt-2",children:e.jsx("div",{className:"flex flex-col gap-1 w-full align-bottom",children:p.map((n,d)=>e.jsxs("div",{className:`flex gap-2 w-full ${j&&"max-md:flex-col"}`,children:[e.jsx(O,{name:`${s}[${d}]`,callback:_,className:"w-full mt-1",value:n.value,getErr:m}),isQuestion&&e.jsx(O,{name:`answer-${i}[${d}]`,callback:_,className:"w-full mt-1",value:n.answer,getErr:m}),e.jsxs("div",{className:`flex
                                ${o&&j?"flex-col":"gap-2"}
                                h-full
                                ${d>0?"justify-end":"justify-start"}`,children:[e.jsx(P,{type:"button",className:`w-fit  "max-md:w-full"
                                     justify-center text-center font-normal bg-blue-500 fill-white mt-1`,onClick:()=>w(`${s}`,""),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M19 11h-6V5h-2v6H5v2h6v6h2v-6h6z"})})}),d>0&&e.jsx(P,{type:"button",className:`w-fit "max-md:w-full"
                                         justify-center text-center font-normal bg-red-500 fill-white mt-1`,onClick:()=>c(d),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M5 11h14v2H5z"})})})]})]},JSON.stringify(f[d])+d))})}):e.jsx("div",{className:"flex gap-2 justify-center align-middle mt-2",children:e.jsx("div",{className:"flex flex-col gap-1 w-full align-bottom",children:p.map((n,d)=>e.jsxs("div",{className:"flex gap-2 w-full max-md:flex-col",children:[e.jsx(O,{name:`${s}[${d}]`,callback:_,className:"w-full mt-1",value:n.value,getErr:m}),isQuestion&&e.jsx(O,{name:`answer-${s}[${d}]`,callback:_,className:"w-full mt-1",value:i,getErr:m})]},JSON.stringify(f[d])+d))})})};function pt({NextButton:a,PrevButton:r,trainingId:b}){const[s,h]=N.useState([]),[j,i]=N.useState(!1),p=f=>{h(f)},t=f=>{console.log("hasErr",f),i(f===!0)},v=()=>{Q.remember(s,"Admin/Training/Craete/Phase-7"),a()};return e.jsxs(V,{value:"evaluation",className:"w-full px-3 py-1",children:[e.jsx("h4",{className:"text-lg font-bold",children:"Variabel Evaluasi"}),e.jsx("div",{className:"flex flex-col gap-3",children:e.jsx(dt,{content:s,handler:p,name:"variables",isRepeater:!0,getErr:t,blockButton:!1,isQuestion:!0,answer_name:"answer"})}),e.jsxs("div",{className:"col-span-full flex justify-between mt-2",children:[e.jsx(P,{type:"button",className:"w-fit justify-start text-left font-normal bg-slate-500 text-white",onClick:()=>r(),children:"< Kembali"}),e.jsx(P,{type:"button",className:"w-fit justify-start text-left font-normal bg-slate-500 text-white",onClick:v,disabled:!j,children:"Lanjutkan >"})]})]})}const kt=({title:a,training:r,targets:b,file_types:s,training_types:h,facilitator:j,organizer:i,controller:p})=>{let[t,v]=N.useState([{name:"training",tooltip:"Pelatihan",svg:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"w-6 h-6",children:e.jsx("path",{d:"M2 3h2v18H2zm18 0h2v18h-2zM5 13h2v1h2v-1h2v1h2v-1h4v1h2v-4h-2v1h-4v-1h-2v1H9v-1H7v1H5zm0-9v4h2V7h8v1h2V7h2V5h-2V4h-2v1H7V4zm0 13v3h2v-1h2v1h2v-1h8v-2h-8v-1H9v1H7v-1H5z"})}),currentState:!1,disabled:!1},{name:"materi",tooltip:"Materi & Jadwal",svg:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M19 4h-3V2h-2v2h-4V2H8v2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2V6c0-1.103-.897-2-2-2zM5 20V7h14V6l.002 14H5z"}),e.jsx("path",{d:"M7 10v2h10V9H7z"})]}),currentState:!1,disabled:!1},{name:"dokumen",tooltip:"Dokumen",svg:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M12.186 14.552c-.617 0-.977.587-.977 1.373 0 .791.371 1.35.983 1.35.617 0 .971-.588.971-1.374 0-.726-.348-1.349-.977-1.349z"}),e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zM9.155 17.454c-.426.354-1.073.521-1.864.521-.475 0-.81-.03-1.038-.06v-3.971a8.16 8.16 0 0 1 1.235-.083c.768 0 1.266.138 1.655.432.42.312.684.81.684 1.522 0 .775-.282 1.309-.672 1.639zm2.99.546c-1.2 0-1.901-.906-1.901-2.058 0-1.211.773-2.116 1.967-2.116 1.241 0 1.919.929 1.919 2.045-.001 1.325-.805 2.129-1.985 2.129zm4.655-.762c.275 0 .581-.061.762-.132l.138.713c-.168.084-.546.174-1.037.174-1.397 0-2.117-.869-2.117-2.021 0-1.379.983-2.146 2.207-2.146.474 0 .833.096.995.18l-.186.726a1.979 1.979 0 0 0-.768-.15c-.726 0-1.29.438-1.29 1.338 0 .809.48 1.318 1.296 1.318zM14 9h-1V4l5 5h-4z"}),e.jsx("path",{d:"M7.584 14.563c-.203 0-.335.018-.413.036v2.645c.078.018.204.018.317.018.828.006 1.367-.449 1.367-1.415.006-.84-.485-1.284-1.271-1.284z"})]}),currentState:!1,disabled:!1},{name:"penyelenggara",tooltip:"Penyelenggara",svg:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M17.988 22a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h11.988zM9 5h6v2H9V5zm5.25 6.25A2.26 2.26 0 0 1 12 13.501c-1.235 0-2.25-1.015-2.25-2.251S10.765 9 12 9a2.259 2.259 0 0 1 2.25 2.25zM7.5 18.188c0-1.664 2.028-3.375 4.5-3.375s4.5 1.711 4.5 3.375v.563h-9v-.563z"})}),currentState:!1,disabled:!1},{name:"fasilitator",tooltip:"Fasilitator",svg:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M15 11h7v2h-7zm1 4h6v2h-6zm-2-8h8v2h-8zM4 19h10v-1c0-2.757-2.243-5-5-5H7c-2.757 0-5 2.243-5 5v1h2zm4-7c1.995 0 3.5-1.505 3.5-3.5S9.995 5 8 5 4.5 6.505 4.5 8.5 6.005 12 8 12z"})}),currentState:!1,disabled:!1},{name:"pengendali",tooltip:"Pengendali",svg:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M21.986 9.74a3.193 3.193 0 0 0-.008-.088A5.003 5.003 0 0 0 17 5H7a4.97 4.97 0 0 0-4.987 4.737c-.01.079-.013.161-.013.253v6.51c0 .925.373 1.828 1.022 2.476A3.524 3.524 0 0 0 5.5 20c1.8 0 2.504-1 3.5-3 .146-.292.992-2 3-2 1.996 0 2.853 1.707 3 2 1.004 2 1.7 3 3.5 3 .925 0 1.828-.373 2.476-1.022A3.524 3.524 0 0 0 22 16.5V10c0-.095-.004-.18-.014-.26zM7 12.031a2 2 0 1 1-.001-3.999A2 2 0 0 1 7 12.031zm10-5a1 1 0 1 1 0 2 1 1 0 1 1 0-2zm-2 4a1 1 0 1 1 0-2 1 1 0 1 1 0 2zm2 2a1 1 0 1 1 0-2 1 1 0 1 1 0 2zm2-2a1 1 0 1 1 0-2 1 1 0 1 1 0 2z"})}),currentState:!1,disabled:!1},{name:"evaluation",tooltip:"Evaluasi",svg:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M20 3H4c-1.103 0-2 .897-2 2v11c0 1.103.897 2 2 2h4l-1.8 2.4 1.6 1.2 2.7-3.6h3l2.7 3.6 1.6-1.2L16 18h4c1.103 0 2-.897 2-2V5c0-1.103-.897-2-2-2zM4 16V5h16l.001 11H4z"}),e.jsx("path",{d:"M6 12h4v2H6z"})]}),currentState:!1,disabled:!1}]),[f,o]=N.useState("training"),[w,c]=N.useState(t);const[_,m]=N.useState({from:r==null?void 0:r.training_start,to:r==null?void 0:r.training_end}),n=()=>{const{trainee:g,trainee_targets:S,competences:T,training_organizer:$,signup_start:M,signup_end:L,training_start:B,training_end:F,files:ut,...he}=r;return{...he,signup_start:new Date(M),signup_end:new Date(L),training_start:new Date(B),training_end:new Date(F),competences:T,target_type:S}},d=g=>g.map(T=>{if(!T.users_id&&T.training_id)return{id:T.id,files:T.files,type:T.file_type,url:`/storage/uploads/${T.file_type}/${T.files}`}}).filter(T=>T!==void 0),l=(g,S,T,$)=>g.filter(B=>B.user.role==T).map(B=>({id:B.id,user_id:B.user.id,files:S.map(F=>F.users_id==B.user.id&&{id:F.id,files:F.files,type:F.file_type,url:F.url}).filter(F=>F!==void 0).filter(F=>typeof F!="boolean")})),x=({name:g,tooltip:S,svg:T,disabled:$})=>e.jsx(je,{children:e.jsxs(Z,{children:[e.jsx(we,{asChild:!0,children:e.jsx(De,{value:g,disabled:$,className:`${f===g?"bg-slate-100 fill-black":"fill-white"}  rounded py-1 px-2 transition-all duration-150 flex flex-col justify-center items-center`,onClick:()=>o(g),children:T})}),e.jsx(ye,{className:"bg-white p-1 rounded-md mt-1 shadow-md shadow-slate-500",side:"bottom",children:e.jsx("p",{className:"text-sm text-black",children:S})})]})},g+new Date().getTime()),u=()=>{const g=t.findIndex(T=>T.name===f);if(g===t.length-1||g===-1)return;t[g].currentState=!0;let S=t[g+1];S.currentState=!1,c(t.map(T=>T.name===f?S:T)),o(t[g+1].name)},y=()=>{const g=t.findIndex(S=>S.name===f);g===0||g===-1||o(t[g-1].name)},k=g=>{const S=r.id;let T=n(),$=d(r.files),M=l(r.training_organizer,r.files,"organizer"),L=l(r.training_organizer,r.files,"facilitator"),B=l(r.training_organizer,r.files,"controller");if(f==="training")return e.jsx(Re,{NextButton:u,training:T,trainingTypes:h,trainingTargets:b});if(f==="materi"&&_)return e.jsx(Ge,{NextButton:u,PrevButton:y,trainingPeriod:_,trainingId:S,scheduleData:T.training_schedule});if(f==="dokumen")return e.jsx(Xe,{file_types:s,NextButton:u,PrevButton:y,trainingId:S,fileData:$});if(f==="penyelenggara")return e.jsx(rt,{organizer:i,organizersData:M,NextButton:u,PrevButton:y,trainingId:S});if(f==="fasilitator")return e.jsx(it,{facilitator:j,storedData:L,NextButton:u,PrevButton:y,trainingId:S});if(f==="pengendali")return e.jsx(ct,{controller:p,storedData:B,NextButton:u,PrevButton:y,trainingId:S});if(f==="evaluation")return e.jsx(pt,{trainingId:S,NextButton:u,PrevButton:y})};return e.jsxs(e.Fragment,{children:[e.jsx(ge,{children:e.jsx("title",{children:a})}),e.jsx(Ie,{className:"w-full pt-2 pb-1 px-2",children:e.jsxs(Pe,{defaultValue:f,value:f,onValueChange:o,className:"w-full h-fit",children:[e.jsx(ze,{className:`grid w-full h-fit gap-1 grid-cols-7 bg-primary text-white mb-4 p-2
                    mx-auto rounded-lg transition-all duration-150
                    `,children:t.map(g=>N.createElement(x,{...g,key:new Date().getTime()%Math.random()}))}),k()]})})]})};export{kt as default};
