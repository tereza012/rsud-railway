import{r as n,j as e,T as N,c as y,U as S,W as P}from"./app-BmJ9-8ba.js";import{L as b,I as K}from"./input-CwNdd4mS.js";import{S as E,a as q,b as A,c as U,d as V,f as _,e as z}from"./select-mkzc42j4.js";import{u as F}from"./useQuery-pHrLegI5.js";const R=n.forwardRef(({className:s,...t},a)=>e.jsx(N,{ref:a,className:y("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...t}));R.displayName=N.displayName;const k=n.forwardRef(({className:s,...t},a)=>e.jsx(S,{ref:a,className:y("aspect-square h-full w-full",s),...t}));k.displayName=S.displayName;const M=n.forwardRef(({className:s,...t},a)=>e.jsx(P,{ref:a,className:y("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...t}));M.displayName=P.displayName;const H=({onFileChange:s,value:t})=>{const[a,i]=n.useState(null),[l,m]=n.useState(null),c=n.useRef(null),o=f=>{var g;const d=(g=f.target.files)==null?void 0:g[0];if(d){if(d.size>2*1024*1024){i(null),s(""),c.current&&(c.current.value="");return}s(d);const u=new FileReader;u.onloadend=()=>{i(u.result)},u.readAsDataURL(d)}else i(null)},p=()=>{var f;(f=c.current)==null||f.click()};let h=t;return t||(h=a??"https://static.vecteezy.com/system/resources/thumbnails/020/911/740/small_2x/user-profile-icon-profile-avatar-user-icon-male-icon-face-icon-profile-icon-free-png.png"),n.useEffect(()=>{m(a)},[a]),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(R,{className:"w-32 h-32 object-cover border border-gray-300 cursor-pointer",onClick:p,children:e.jsx(k,{src:l??h,alt:"User Picture",className:"object-cover object-center"})}),e.jsx(b,{htmlFor:"profile_picture",className:"self-start w-full flex flex-col gap-2",children:"Foto Profil"}),e.jsx("input",{type:"file",accept:"image/*",onChange:o,name:"profile_picture",ref:c,className:"w-full rounded-lg border-2 border-slate-500 text-slate-800 focus:border-blue-500",hidden:t!==void 0}),t&&e.jsx(K,{type:"text",name:"gapenting",value:"Klik untuk ubah profil",readOnly:!0,onClick:p,className:"w-full rounded-lg cursor-pointer border-2 border-slate-500 p-3 text-slate-800 focus:border-blue-500"})]})},v=({items:s,name:t,placeholder:a,onValueChange:i,disabled:l=!1,isLoading:m,value:c})=>e.jsxs(E,{name:t,onValueChange:i,disabled:l,value:c,children:[e.jsx(q,{className:"w-full rounded-lg border-2 border-slate-500 p-3 text-slate-800 focus:border-blue-500",children:e.jsx(A,{placeholder:`Pilih ${a}`})}),e.jsx(U,{children:e.jsxs(V,{children:[e.jsx(_,{children:a}),s.map(o=>e.jsx(z,{value:o,children:o},o))]})})]}),T=async()=>{const s=await fetch("/api/provinces");if(!s.ok)throw new Error("Failed to fetch provinces");return await s.json()},$=async s=>{const t=await fetch(`/api/regencies/${s}`);if(!t.ok)throw new Error("Failed to fetch regencies");return await t.json()},D=()=>F({queryKey:["provinces"],queryFn:T}),G=s=>F({queryKey:["regencies",s],queryFn:()=>$(s),enabled:!!s}),J=({errorsProv:s,errorsRegen:t,valueProv:a,valueRegen:i})=>{const{data:l,isLoading:m,error:c}=D(),o=n.useMemo(()=>(l==null?void 0:l.reduce((r,x)=>(r[x.name]=x.id,r),{}))||{},[l]),p=r=>o[r],[h,f]=n.useState(a||""),[d,g]=n.useState(p(h)||""),{data:u,isLoading:w,error:j}=G(d),[C,L]=n.useState(i||""),I=r=>{const x=o[r];f(r),g(x)};return n.useEffect(()=>{if(a){const r=p(a);g(r)}},[o]),e.jsxs(e.Fragment,{children:[e.jsx(b,{htmlFor:"province",children:"Provinsi"}),e.jsx(v,{items:(l==null?void 0:l.map(r=>r.name))||[],name:"province",placeholder:"Provinsi",onValueChange:I,disabled:m,isLoading:m,value:h}),s&&e.jsx("span",{className:"text-red-500 text-sm",children:s||(c==null?void 0:c.message)}),e.jsx(b,{htmlFor:"regency",className:"mt-3",children:"Kabupaten/Kota"}),e.jsx(v,{items:(u==null?void 0:u.map(r=>r.name))||[],name:"regency",placeholder:"Kabupaten/Kota",disabled:!d&&w,isLoading:w,onValueChange:L,value:C}),t&&e.jsx("span",{className:"text-red-500 text-sm",children:t||(j==null?void 0:j.message)})]})};export{v as I,H as P,J as a};
