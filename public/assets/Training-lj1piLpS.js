import{q as K,r as f,u as ne,j as e,B,c as he,a9 as Ae,a as ee,y as be,aa as Ue,ab as X,Y as Ke}from"./app-BmJ9-8ba.js";import{a as ce,T as te,b as Je,S as _e,P as Ge,c as Ze,f as R,d as We,C as qe,R as Ye,u as le,e as Ne,g as ve,h as Q,i as U,j as Se,k as O,l as re,U as Ce,m as ke,n as Te,o as ze,p as Me,q as oe}from"./TraininMembersFile-DxPtgNYC.js";import{C as de,a as De,b as Be,c as Qe,d as Xe}from"./card-CiqlAvGj.js";import{T as me,a as fe,b as xe,c as ge,d as et,e as tt,f as st,g as at}from"./tooltip-3_zJHBHr.js";import{S as Fe,a as Pe,b as $e,c as Ie,e as Ee,d as nt}from"./select-mkzc42j4.js";import{z as k,I as P,L as F}from"./input-CwNdd4mS.js";import{u as lt,v as rt}from"./index-DNT3TRw4.js";import{e as je,P as ye}from"./index-B8jzc5xN.js";import{A as it,a as ct,c as ot}from"./accordion-BiXchzLQ.js";import"./app-BWRYm4UO.js";import"./useQuery-pHrLegI5.js";import"./tiny-invariant-CopsF_GD.js";const dt=k.object({type:k.string().min(1),description:k.string().min(1),name:k.string().min(1),purpose:k.string().min(1),signup_start:k.coerce.date(),signup_end:k.coerce.date(),training_start:k.coerce.date(),training_end:k.coerce.date(),batch:k.number().min(1),capacity:k.number().min(1),skp:k.number().min(1),jpl:k.number().min(0),cost:k.number().min(1),cp:k.string().min(1),whatsapp_link:k.string().min(1),competences:k.array(k.string().min(1)).nonempty(),target_type:k.array(k.string().min(1)).nonempty()}).superRefine(({signup_start:s,signup_end:l,training_start:p},t)=>{const r=new Date(s),u=new Date(l),x=new Date(p);x<r&&x<u&&t.addIssue({code:"custom",message:"Periode pelatihan tidak boleh kurang dari periode pendaftaran",path:["training_start"]})}),pt=({selectedTypes:s,trainingTypes:l,callback:p})=>{const[t,r]=f.useState(s),u=x=>{r(x),p(x)};return f.useEffect(()=>{s===""||!s||r(s)},[s]),e.jsxs(F,{className:"text-sm font-medium flex flex-col gap-1 col-span-1 max-md:col-span-full",children:["Jenis Pelatihan",e.jsxs(Fe,{name:"type",value:t,onValueChange:u,children:[e.jsx(Pe,{className:"w-full",children:e.jsx($e,{placeholder:t||"Pilih Jenis Pelatihan","aria-label":t})}),e.jsx(Ie,{children:l.map(x=>e.jsx(Ee,{value:x,children:x},new Date().getTime()%Math.random()))})]})]})},ut=({selectedTargets:s,trainingTargets:l,callback:p})=>{const[t,r]=f.useState([]),u=[];l.map(n=>{u.push({value:n,label:n})});const x=n=>{const d=n.map(i=>i.value);r(d),p(d)};return e.jsx(_e,{value:u.map((n,d)=>(s==null?void 0:s.includes(n.value))&&n),isMulti:!0,name:`target_type[${t.length-1>=0?t.length-1:0}]`,options:u,className:"basic-multi-select",classNamePrefix:"select",placeholder:"Target Peserta (Tenaga Medis dll)",onChange:x})},we=({name:s,className:l,callback:p,presetDate:t})=>{var n,d;const[r,u]=f.useState({from:t.from||new Date,to:t.to||ce(new Date,2)}),x=i=>{i&&(u(i),p&&(i!=null&&i.to)&&p(i,s))};return e.jsxs("div",{className:he("grid gap-2",l),children:[e.jsxs(Ge,{children:[e.jsx(Ze,{asChild:!0,children:e.jsxs(B,{id:"date",variant:"outline",className:he("w-full justify-start text-left font-normal",!r&&"text-muted-foreground"),children:[e.jsx(Ae,{className:"mr-2 h-4 w-4"}),r!=null&&r.from?r.to?e.jsxs(e.Fragment,{children:[R(r==null?void 0:r.from,"LLL dd, y")," - "," ",R(r==null?void 0:r.to,"LLL dd, y")]}):R(r==null?void 0:r.from,"LLL dd, y"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(We,{className:"w-auto p-0",align:"start",children:e.jsx(qe,{initialFocus:!0,mode:"range",defaultMonth:r==null?void 0:r.from,selected:r,onSelect:x,onMonthChange:()=>{},numberOfMonths:2})})]}),e.jsx(P,{type:"text",name:`${s}_start`,value:(n=r==null?void 0:r.from)==null?void 0:n.toString(),placeholder:"Periode Pelatihan",hidden:!0,readOnly:!0,className:"hidden"}),e.jsx(P,{type:"text",name:`${s}_end`,value:r.to?(d=r==null?void 0:r.to)==null?void 0:d.toString():"",placeholder:"Periode Pelatihan",hidden:!0,readOnly:!0,className:"hidden"})]})},ht=({name:s,callback:l,className:p,value:t,err:r})=>{const[u,x]=f.useState(t??""),n=i=>{x(i.target.value)},d=i=>{i.key==="Enter"&&l&&l(s,i.target.value)};return e.jsxs("div",{className:"flex flex-col gap-1 w-full",children:[e.jsx(P,{type:"text",name:s,className:p,placeholder:"",defaultValue:u,onKeyDown:d,onChange:n}),e.jsx("span",{className:"text-xs text-slate-400",children:"*Tekan Enter untuk Konfirmasi"}),e.jsx("span",{className:"text-sm text-red-500",children:r})]})},mt=({content:s,handler:l,errors:p})=>{const t="competences",[r,u]=f.useState(s.length>0?s==null?void 0:s.map((m,y)=>({name:t,value:m})):[{name:t,value:""}]),[,x]=f.useState(0);f.useMemo(()=>r,[r]);const n=(m,y,v)=>{u([...r,{name:m,value:y}])},d=m=>{u(r.filter((y,v)=>v!==m))},i=(m,y)=>{const v=m.split("[")[1].replace("]",""),b=r.map((S,h)=>h===Number.parseInt(v)?{...S,value:y}:S);if(u(b),l){const S=b.map(h=>h.value);l(S)}};return f.useEffect(()=>{s.length>0&&u(s.map(m=>({name:t,value:m}))),x(m=>m+1)},[]),f.useEffect(()=>{s.length>0&&u(s.map(m=>({name:t,value:m}))),x(m=>m+1)},[s]),e.jsx("div",{className:"flex gap-2 justify-center align-middle",children:e.jsxs(F,{className:"flex flex-col gap-1 w-full",children:[e.jsx("span",{className:"text-sm font-bold",children:"Kompetensi"}),r&&r.map((m,y)=>e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsx(ht,{name:`${t}[${y}]`,callback:i,className:"w-full",value:m.value,err:p&&p.keys.length>0?p[y]:null}),e.jsx(B,{type:"button",className:"w-fit justify-start text-left font-normal bg-blue-500 fill-white",onClick:()=>n(`${t}`,"",r.length),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M19 11h-6V5h-2v6H5v2h6v6h2v-6h6z"})})}),y>0&&e.jsx(B,{type:"button",className:"w-fit justify-start text-left font-normal bg-red-500 fill-white",onClick:()=>d(y),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M5 11h14v2H5z"})})})]},JSON.stringify(m)+y))]})})},ft=async s=>(await ee.post("/api/admin/training/phase1",s)).data;function xt({NextButton:s,handleTrainingSubmit:l,trainingData:p,trainingTypes:t,trainingTargets:r}){var Z,W;const x=K().props.csrf_token,[n,d]=f.useState(!1),[i,m]=f.useState(p||{name:"",description:"",purpose:"",signup_start:new Date,signup_end:ce(new Date,2),training_start:new Date,training_end:ce(new Date,2),type:"",batch:0,capacity:0,skp:0,jpl:0,cost:0,cp:"",whatsapp_link:"",competences:[],target_type:[]}),[y,v]=f.useState([]),[,b]=f.useReducer(N=>N+1,0),{toast:S}=ne(),h=async(N,H)=>{H.event.preventDefault(),N.target_type[0]===""&&(S({title:"Gagal",description:"Target peserta tidak boleh kosong",variant:"destructive",duration:5e3}),H.abort());const D={name:N.name,description:N.description,purpose:N.purpose,signup_start:N.signup_start,signup_end:N.signup_end,training_start:N.training_start,training_end:N.training_end,type:N.type,batch:N.batch,capacity:N.capacity,skp:N.skp,jpl:N.jpl,cost:N.cost,cp:N.cp,whatsapp_link:N.whatsapp_link,competences:N.competences,target_type:N.target_type},ie={name:D.name,description:D.description,purpose:D.purpose,signup_start:R(D.signup_start,"yyyy-MM-dd"),signup_end:R(D.signup_end,"yyyy-MM-dd"),training_start:R(D.training_start,"yyyy-MM-dd"),training_end:R(D.training_end,"yyyy-MM-dd"),type:D.type,batch:D.batch,capacity:D.capacity,skp:D.skp,jpl:D.jpl,cost:D.cost,cp:D.cp,whatsapp_link:D.whatsapp_link,name_competences:D.competences,target_type:D.target_type},q=await ft(ie);q.success?(S({title:"Berhasil",description:q.message,variant:"default",duration:5e3}),l(D),d(!0),s()):S({title:"Gagal",description:q.message,variant:"destructive",duration:5e3})};let{form:o,errors:a,isSubmitting:c,setInitialValues:j,data:g,setFields:_}=lt({extend:rt({schema:dt}),onSubmit:h,onError:N=>{console.error(N)}});f.useEffect(()=>{p&&(m(p),v(p==null?void 0:p.competences),j({...p}),_("signup_start",new Date(p.signup_start)),_("signup_end",new Date(p.signup_end)),_("training_start",new Date(p.training_start)),_("training_end",new Date(p.training_end)),b())},[]);const T=N=>{m({...i,[N.target.name]:N.target.value})},V=(N,H)=>{if(N!=null&&N.from)switch(m({...i,[`${H}_start`]:N==null?void 0:N.from}),H){case"signup":_("signup_start",N.from);break;case"training":_("training_start",N.from);break}if(N!=null&&N.to)switch(m({...i,[`${H}_end`]:N==null?void 0:N.to}),H){case"signup":_("signup_end",N.to);break;case"training":_("training_end",N.to);break}},J=N=>{v(N),m({...i,competences:N})},se=N=>{m({...i,type:N})},ae=N=>{m({...i,target_type:N})};return e.jsxs(te,{value:"training",className:"w-full px-3 py-1",children:[e.jsx("h4",{className:"text-lg font-bold",children:"Detail Pelatihan"}),e.jsx("div",{className:"flex flex-col gap-3",children:e.jsxs("form",{ref:o,className:"grid max-md:grid-cols-1 grid-cols-2 gap-4 py-2",children:[e.jsx(P,{type:"text",readOnly:!0,name:"_token",className:"hidden",value:x==null?void 0:x.toString()}),e.jsx(pt,{selectedTypes:i.type,trainingTypes:t,callback:se}),e.jsxs(F,{children:[e.jsx("span",{className:"text-sm font-bold",children:"Nama Pelatihan"}),e.jsx(P,{type:"text",name:"name",placeholder:"Nama Pelatihan",defaultValue:i.name,onChange:T}),e.jsx("span",{className:"text-sm text-red-500",children:a().name})]}),e.jsxs(F,{children:[e.jsx("span",{className:"text-sm font-bold",children:"Deskripsi Pelatihan"}),e.jsx(P,{type:"text",name:"description",placeholder:"Deskripsi Pelatihan",defaultValue:i==null?void 0:i.description,onChange:T}),e.jsx("span",{className:"text-sm text-red-500",children:a().description})]}),e.jsxs(F,{className:"text-sm font-medium flex flex-col gap-1 col-span-1 max-md:col-span-full",children:["Target Peserta",e.jsx(ut,{selectedTargets:i&&i.target_type,trainingTargets:r,callback:ae}),e.jsx("span",{className:"text-sm text-red-500",children:(Z=a())==null?void 0:Z.target_type})]}),e.jsxs(F,{children:[e.jsx("span",{className:"text-sm font-bold",children:"Tujuan Pelatihan"}),e.jsx(Je,{name:"purpose",placeholder:"Tujuan Pelatihan",defaultValue:i&&i.purpose,onChange:T}),e.jsx("span",{className:"text-sm text-red-500",children:a().purpose},new Date().getTime()%Math.random())]}),e.jsx("div",{className:"w-full",children:e.jsx(mt,{content:y,errors:((W=a())==null?void 0:W.competences)??null,handler:J})}),e.jsxs(F,{children:[e.jsx("span",{className:"text-sm font-bold",children:"Periode Pendaftaran"}),e.jsx(we,{name:"signup",className:"w-full",presetDate:{from:new Date(i.signup_start),to:new Date(i.signup_end)},callback:V}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm text-red-500",children:a().signup_start}),e.jsx("span",{className:"text-sm text-red-500",children:a().signup_end})]})]}),e.jsxs(F,{children:[e.jsx("span",{className:"text-sm font-bold",children:"Periode Pelatihan"}),e.jsx(we,{name:"training",className:"w-full",presetDate:{from:new Date(i.training_start),to:new Date(i.training_end)},callback:V}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm text-red-500",children:a().training_start}),e.jsx("span",{className:"text-sm text-red-500",children:a().training_end})]})]}),e.jsxs(F,{children:[e.jsx("span",{className:"text-sm font-bold",children:"Gelombang / Batch"}),e.jsx(P,{type:"number",name:"batch",placeholder:"Gelombang / Batch",defaultValue:i?i.batch:null,onChange:T}),e.jsx("span",{className:"text-sm text-red-500",children:a().batch})]}),e.jsxs(F,{children:[e.jsx("span",{className:"text-sm font-bold",children:"Kuota Pelatihan"}),e.jsx(P,{type:"number",name:"capacity",placeholder:"Kuota Pelatihan",defaultValue:i?i.capacity:null,onChange:T}),e.jsx("span",{className:"text-sm text-red-500",children:a().capacity})]}),e.jsxs(F,{children:[e.jsx("span",{className:"text-sm font-bold",children:"Biaya Pelatihan"}),e.jsx(P,{type:"number",name:"cost",placeholder:"Kuota Pelatihan",defaultValue:i?i.cost:null,onChange:T}),e.jsx("span",{className:"text-sm text-red-500",children:a().cost})]}),e.jsxs(F,{children:[e.jsx("span",{className:"text-sm font-bold",children:"Jumlah SKP"}),e.jsx(P,{type:"number",name:"skp",placeholder:"Jumlah SKP",defaultValue:i?i.skp:null,onChange:T}),e.jsx("span",{className:"text-sm text-red-500",children:a().skp})]}),e.jsxs(F,{children:[e.jsx("span",{className:"text-sm font-bold",children:"Jumlah JPL"}),e.jsx(P,{type:"number",name:"jpl",placeholder:"Jumlah JPL",defaultValue:i?i.jpl:null,onChange:T}),e.jsx("span",{className:"text-sm text-red-500",children:a().jpl})]}),e.jsxs(F,{children:[e.jsx("span",{className:"text-sm font-bold",children:"CP"}),e.jsx(P,{type:"text",name:"cp",placeholder:"CP",defaultValue:i?i.cp:null,onChange:T}),e.jsx("span",{className:"text-sm text-red-500",children:a().cp})]}),e.jsxs(F,{children:[e.jsx("span",{className:"text-sm font-bold",children:"Link WA (WhatsApp)"}),e.jsx(P,{type:"url",name:"whatsapp_link",placeholder:"Link WA",defaultValue:i?i.whatsapp_link:null,onChange:T}),e.jsx("span",{className:"text-sm text-red-500",children:a().whatsapp_link})]}),e.jsx("div",{className:"col-span-full flex justify-end",children:e.jsx(B,{type:"submit",className:"w-fit justify-start text-left font-normal bg-slate-500 text-white",disabled:c(),children:"Lanjutkan"})})]})})]})}const gt=async s=>(await ee.post("/api/admin/training/phase2",s)).data;function jt({NextButton:s,PrevButton:l,trainingPeriod:p,obtainData:t,scheduleData:r}){var b,S;const[u,x]=f.useState([]),[n,d]=f.useState({from:p==null?void 0:p.from,to:p==null?void 0:p.to}),{toast:i}=ne(),m=K().props.csrf_token,y=h=>{x(h),console.log("SCHEDULE DATA",h)},v=async()=>{const h=u.map(c=>({materi_name:c.title,desc_schedule:c.description,start_at:R(c.start,"yyyy-MM-dd HH:mm:ss"),end_at:R(c.end,"yyyy-MM-dd HH:mm:ss")})),a=await gt({_token:m,schedule_content:h});a.success?(i({title:"Berhasil",description:a.message,variant:"default",duration:5e3}),t(h),s()):i({title:"Gagal",description:a.message,variant:"destructive",duration:5e3})};return f.useEffect(()=>{if(d(p),r.length>0){const h=r.map(o=>({title:o.materi_name,description:o.desc_schedule,start:new Date(o.start_at),end:new Date(o.end_at)}));x(h)}},[]),f.useEffect(()=>{if(r.length>0){const h=r.map(o=>({title:o.materi_name,description:o.desc_schedule,start:new Date(o.start_at),end:new Date(o.end_at)}));x(h)}},[r]),e.jsxs(te,{value:"materi",className:"w-full px-3 py-1",children:[e.jsx("h4",{className:"text-lg font-bold",children:"Jadwal dan Materi"}),e.jsxs("span",{className:"text-sm font-bold",children:[(b=n==null?void 0:n.from)==null?void 0:b.toLocaleDateString()," -"," ",(S=n==null?void 0:n.to)==null?void 0:S.toLocaleDateString()]}),e.jsx("div",{className:"flex flex-col gap-3",children:e.jsxs("div",{className:"grid max-md:grid-cols-1 grid-cols-2 gap-4 py-2",children:[e.jsx("div",{className:"col-span-full",children:n&&n.from&&n.to?e.jsx(Ye,{minDate:n==null?void 0:n.from,maxDate:n==null?void 0:n.to,obtainSchedule:y,stores:u}):""}),e.jsxs("div",{className:"col-span-full flex justify-between",children:[e.jsx(B,{type:"button",className:"w-fit justify-start text-left font-normal bg-slate-500 text-white",onClick:()=>l(),children:"< Kembali"}),e.jsx(B,{type:"button",className:"w-fit justify-start text-left font-normal bg-slate-500 text-white",onClick:v,children:"Lanjutkan >"})]})]})})]})}const yt=k.object({content:k.instanceof(File).superRefine((s,l)=>{s.size>2*1024*1024&&l.addIssue({code:k.ZodIssueCode.custom,message:"Ukuran file tidak boleh lebih dari 2MB"}),s.name===""&&l.addIssue({code:k.ZodIssueCode.custom,message:"File tidak boleh kosong"})}),type:k.string().min(1)}),wt=({name:s,callback:l,className:p,value:t,file_type:r,getErr:u})=>{var a;const[x,n]=f.useState((t==null?void 0:t.content)??new File([],"")),[d,i]=f.useState((t==null?void 0:t.type)??""),[m,y]=f.useState(((a=t==null?void 0:t.content)==null?void 0:a.name)??""),[v,b]=f.useState(null);f.useEffect(()=>{t!=null&&t.content&&(n(t.content),i(t.type),y(t.content.name),h(t.content,t.type))},[t]),f.useEffect(()=>{t!=null&&t.content&&(n(t.content),i(t.type),y(t.content.name),l&&l(s,{content:t.content,type:t.type}),h(t.content,t.type))},[]),f.useEffect(()=>{t!=null&&t.content&&(n(t.content),i(t.type),y(t.content.name),l&&l(s,{content:t.content,type:t.type}),h(x,d))},[x,d]);const S=c=>{if(c.target.files.length===0)return;const j=c.target.files[0];n(j),h(j,d),l&&l(s,{content:j,type:d})},h=(c,j)=>{try{yt.parse({content:c,type:j}),u(v===null)}catch(g){g instanceof k.ZodError&&(b(g),u(v===null))}},o=c=>{i(c),h(x,c),l&&l(s,{content:x,type:c})};return e.jsx("div",{className:"flex flex-col gap-1 w-full",children:e.jsxs("div",{className:"grid grid-cols-5 max-md:grid-cols-1 gap-1 w-full",children:[e.jsxs(F,{className:"w-full col-span-4",children:[e.jsx("p",{className:"truncate max-w-[75%] text-sm",children:m===""?"Dokumen":m}),e.jsx(P,{type:"file",name:s,id:s,className:Ue("w-full",p),"aria-label":m,placeholder:m,accept:"application/pdf",onChange:S}),v&&e.jsx("span",{className:"text-sm text-red-500",children:v.issues.map(c=>c.path.includes("content")?c.message:null)})]}),e.jsxs(F,{className:"w-full col-span-1",children:["Tipe Dokumen",e.jsxs(Fe,{name:`${s}_type`,onValueChange:o,value:d,children:[e.jsx(Pe,{className:"w-full mt-1",children:e.jsx($e,{placeholder:"Select a fruit"})}),e.jsx(Ie,{children:e.jsx(nt,{children:r.map(c=>e.jsx(Ee,{value:c,children:c.toUpperCase()},c+Date.now()%Math.random()))})})]}),v&&e.jsx("span",{className:"text-sm text-red-500",children:v.issues.map(c=>c.path.includes("type")?c.message:null)})]})]})})},bt=({content:s,handler:l,file_type:p,getErr:t})=>{const r="file",[u,x]=f.useState((s==null?void 0:s.length)>0?s==null?void 0:s.map(b=>({name:r,value:b})):[{name:r,value:{content:new File([],""),type:""}}]),[,n]=f.useState(0),d=f.useMemo(()=>u,[u]);f.useEffect(()=>{s.length>0&&x(s.map(b=>({name:r,value:b}))),n(b=>b+1)},[s]),f.useEffect(()=>{s.length>0&&x(s.map(b=>({name:r,value:b}))),n(b=>b+1)},[]);const i=(b,S)=>{x([...u,{name:b,value:S}])},m=b=>{x(u.filter((S,h)=>h!==b))},y=(b,S)=>{const h=b.split("[")[1].replace("]",""),o=u.map((a,c)=>c===parseInt(h)?{...a,value:S}:a);x(o),l&&l(o.map(a=>a.value))},v=b=>{t(b)};return e.jsx("div",{className:"flex gap-2 justify-center align-middle mt-2",children:e.jsx("div",{className:"flex flex-col gap-4 w-full",children:u.map((b,S)=>e.jsxs("div",{className:"w-full grid grid-cols-10 gap-2 max-md:grid-cols-5",children:[e.jsx("div",{className:"w-full col-span-8 max-md:col-span-3",children:e.jsx(wt,{name:`${r}[${S}]`,callback:y,className:"w-full mt-1",value:b.value,file_type:p,getErr:v})}),e.jsxs("div",{className:"col-span-2 w-full h-full flex gap-2 max-md:flex-col justify-center",children:[e.jsx(B,{type:"button",className:"w-full max-md:h-full justify-center text-left font-normal bg-blue-500 fill-white mt-4 max-md:mt-0",onClick:()=>i(`${r}`,{content:new File([],""),type:""}),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M19 11h-6V5h-2v6H5v2h6v6h2v-6h6z"})})}),S>0&&e.jsx(B,{type:"button",className:"w-full max-md:h-full justify-center text-left font-normal bg-red-500 hover:bg-red-600 fill-white mt-4 max-md:mt-0",onClick:()=>m(S),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M5 11h14v2H5z"})})})]})]},JSON.stringify(d[S])+S))})})},_t=async s=>(await ee.post("/api/admin/training/phase3",s)).data,Nt=(s,l)=>{let p=[];return s.length!==l.length?!0:(l.map((t,r)=>{var n,d;const u=(n=s.find(i=>i.content.name===t.files))==null?void 0:n.content.name,x=(d=s.find(i=>i.content.name===t.files))==null?void 0:d.type;(u!==t.files||x!==t.file_type)&&(p[r]=!0)}),p.some(t=>t===!0))};function vt({file_types:s,NextButton:l,PrevButton:p,obtainValue:t,fileData:r}){const[u,x]=f.useState([]),[n,d]=f.useState(!1),{toast:i}=ne(),m=K().props.csrf_token,y=f.useCallback(a=>{x(a)},[]),{data:v,isLoading:b,error:S}=le(r.map(a=>a.url),"docsData",r.map(a=>a.files));S&&ee.delete("/api/cookie/admin-training-phase-3").then(()=>{i({title:"Error",description:"Tidak dapat menemukan file yang dibutuhkan",variant:"destructive",duration:5e3}),be.visit("/admin/training")}),f.useEffect(()=>{if(!v||v.length<1||S)return;const a=v.map((c,j)=>{const g=r.find(_=>_.files===c.name);if(r.length<=v.length&&g)return{content:c,type:g.file_type}});a.some(c=>!c)||x(a)},[v]);const h=async()=>{if(!Nt(u,r)&&u.length>0){l();return}const c=new FormData;u.forEach((g,_)=>{c.append(`files[${_}]`,g.content),c.append(`file_type[${_}]`,g.type)}),c.append("_token",m);const j=await _t(c);if(j.success){i({title:"Berhasil",description:j.message,variant:"default",duration:5e3});const g=j.data.file.files.map((_,T)=>({file_type:j.data.file.file_type[T],files:_,url:j.data.url[T]}));t(g),l()}else i({title:"Gagal",description:j.message,variant:"destructive",duration:5e3}),console.error("Error: ",j.data)},o=a=>{d(a)};return e.jsxs(te,{value:"dokumen",className:"w-full px-3 py-1",children:[e.jsx("h4",{className:"text-lg font-bold",children:"File Pendukung"}),e.jsx("div",{className:"flex flex-col gap-3",children:e.jsx(bt,{content:u,handler:y,file_type:s,getErr:o})}),e.jsxs("div",{className:"col-span-full flex justify-between mt-4",children:[e.jsx(B,{type:"button",className:"w-fit justify-start text-left font-normal bg-slate-500 text-white",onClick:()=>p(),children:"< Kembali"}),e.jsx(B,{type:"button",className:"w-fit justify-start text-left font-normal bg-slate-500 text-white",disabled:!n,onClick:h,children:"Lanjutkan >"})]})]})}const St=({selectedTargets:s,trainingTargets:l,callback:p})=>{const[t,r]=f.useState([]),u=[];l.map(n=>{u.push({value:n.id,label:n.name})});const x=n=>{const d=n.map(m=>m.value),i=l.filter(m=>d.some(y=>y===m.id));r(d),typeof d<"u"&&p(i)};return e.jsx(_e,{value:u.map(n=>(s==null?void 0:s.some(d=>d.id===n.value))&&n),isMulti:!0,name:`organizer[${t.length-1>=0?t.length-1:0}]`,options:u,className:"basic-multi-select",classNamePrefix:"select",placeholder:"Target Peserta (Tenaga Medis dll)",onChange:x})},Ct=k.object({content:k.instanceof(File).superRefine((s,l)=>{s.size>2*1024*1024&&l.addIssue({code:k.ZodIssueCode.custom,message:`Ukuran file ${s.name} tidak boleh lebih dari 2MB`}),s.name===""&&l.addIssue({code:k.ZodIssueCode.custom,message:"File tidak boleh kosong"})}),user_id:k.number()}),kt=({selected:s,obtainValue:l,storedData:p})=>{const[t,r]=f.useState(null),[u,x]=f.useState([]),n=y=>{if(y.target.files.length===0)return;const v=y.target.files[0],b=y.target.name.split("_"),S=parseInt(b[b.length-1]),h={user_id:S,content:v,type:"spt"};let o=u.filter(a=>a.type!="spt"||a.user_id!=S);m([...o,h]),x([...o,h]),l([...o,h])},d=y=>{if(y.target.files.length===0)return;const v=y.target.files[0],b=y.target.name.split("_"),S=parseInt(b[b.length-1]),h={user_id:S,content:v,type:"sk"};let o=u.filter(a=>a.user_id!=S||a.type!="sk");m([...o,h]),x([...o,h]),l([...o,h])},i=(y,v,b)=>{const S={user_id:y,content:v,type:b};x([...u,S])};f.useEffect(()=>{p.length>0&&x(p)},[p]),f.useEffect(()=>{if(p.length>0)s.map(y=>{const v=[];p.map(b=>{b.user_id==y.id&&v.push(b)}),x(v)});else{const y=[];s.map(v=>{i(v.id,new File([],""),"spt"),i(v.id,new File([],""),"sk")}),x(y)}},[]);const m=y=>{y.map(v=>{try{Ct.parse({content:v.content,type:v.type,user_id:v.user_id})}catch(b){b instanceof k.ZodError&&r(b)}})};return e.jsxs(Ne,{children:[e.jsx(ve,{children:e.jsxs(Q,{children:[e.jsx(U,{className:"w-fit",children:"No"}),e.jsx(U,{children:"Nama"}),e.jsx(U,{hidden:!0,children:"Download SPT & SPK"}),e.jsx(U,{hidden:!0,className:"text-right",children:"Upload SPT & SPK"})]})}),e.jsx(Se,{children:s.map((y,v)=>{var b,S;return e.jsxs(Q,{children:[e.jsx(O,{className:"font-medium",children:v+1}),e.jsx(O,{className:"flex gap-2",children:y.name}),e.jsx(O,{}),e.jsxs(O,{className:"text-right",children:[e.jsxs("div",{className:"flex gap-2",children:[u.find(h=>h.type=="spt"&&h.content.size>0&&h.user_id==y.id)?e.jsx(me,{children:e.jsxs(fe,{children:[e.jsx(xe,{asChild:!0,className:"my-auto",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:`w-6 h-6 ${t?"fill-red-500":""}`,viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"}),e.jsx("path",{d:"M11 11h2v6h-2zm0-4h2v2h-2z"})]})}),e.jsx(ge,{className:"bg-white p-2 border-2 border-primary",children:e.jsx("div",{className:"w-full flex justify-center max-h-[52vh] overflow-scroll",children:t?e.jsx("span",{className:"text-sm text-red-500",children:t.issues.map(h=>h.path.includes("content")?h.message:null)}):e.jsx(je,{file:URL.createObjectURL(((b=p.find(h=>y.id==h.user_id&&h.type=="spt"))==null?void 0:b.content)??new File([],"")),className:"mt-2 h-full w-full",children:e.jsx(ye,{pageNumber:1,renderTextLayer:!1,renderAnnotationLayer:!1,className:"h-full overflow-hidden rounded shadow-slate-300 shadow-xl"})})})})]})}):"",e.jsxs(B,{className:"bg-blue-500 text-white fill-white mr-1 gap-1",onClick:()=>{var h;return(h=document.getElementById("spt_u_"+y.id))==null?void 0:h.click()},children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M13 19v-4h3l-4-5-4 5h3v4z"}),e.jsx("path",{d:"M7 19h2v-2H7c-1.654 0-3-1.346-3-3 0-1.404 1.199-2.756 2.673-3.015l.581-.102.192-.558C8.149 8.274 9.895 7 12 7c2.757 0 5 2.243 5 5v1h1c1.103 0 2 .897 2 2s-.897 2-2 2h-3v2h3c2.206 0 4-1.794 4-4a4.01 4.01 0 0 0-3.056-3.888C18.507 7.67 15.56 5 12 5 9.244 5 6.85 6.611 5.757 9.15 3.609 9.792 2 11.82 2 14c0 2.757 2.243 5 5 5z"})]}),"Upload SPT"]})]}),e.jsxs("div",{className:"flex gap-2",children:[u.find(h=>h.type==="sk"&&h.content.size>0&&h.user_id==y.id)?e.jsx(me,{children:e.jsxs(fe,{children:[e.jsx(xe,{asChild:!0,className:"my-auto",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:`w-6 h-6 ${t?"fill-red-500":""}`,viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"}),e.jsx("path",{d:"M11 11h2v6h-2zm0-4h2v2h-2z"})]})}),e.jsx(ge,{className:"bg-white p-2 border-2 border-primary",children:e.jsx("div",{className:"w-full flex justify-center max-h-[52vh] overflow-scroll",children:t?e.jsx("span",{className:"text-sm text-red-500",children:t.issues.map(h=>h.path.includes("content")?h.message:null)}):e.jsx(je,{file:URL.createObjectURL(((S=p.find(h=>y.id==h.user_id&&h.type=="sk"))==null?void 0:S.content)??new File([],"")),className:"mt-2 h-full w-full",children:e.jsx(ye,{pageNumber:1,renderTextLayer:!1,renderAnnotationLayer:!1,className:"h-full overflow-hidden rounded shadow-slate-300 shadow-xl"})})})})]})}):"",e.jsxs(B,{className:"bg-blue-500 text-white fill-white mt-1 gap-1",onClick:()=>{var h;return(h=document.getElementById("sk_u_"+y.id))==null?void 0:h.click()},children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M13 19v-4h3l-4-5-4 5h3v4z"}),e.jsx("path",{d:"M7 19h2v-2H7c-1.654 0-3-1.346-3-3 0-1.404 1.199-2.756 2.673-3.015l.581-.102.192-.558C8.149 8.274 9.895 7 12 7c2.757 0 5 2.243 5 5v1h1c1.103 0 2 .897 2 2s-.897 2-2 2h-3v2h3c2.206 0 4-1.794 4-4a4.01 4.01 0 0 0-3.056-3.888C18.507 7.67 15.56 5 12 5 9.244 5 6.85 6.611 5.757 9.15 3.609 9.792 2 11.82 2 14c0 2.757 2.243 5 5 5z"})]}),"Upload SK"]})]}),e.jsx(P,{type:"file",name:`spt_u_${y.id}`,id:`spt_u_${y.id}`,className:"hidden",accept:"application/pdf",onChange:n}),e.jsx(P,{type:"file",name:`sk_u_${y.id}`,id:`sk_u_${y.id}`,className:"hidden",accept:"application/pdf",onChange:d})]})]},y.username+y.id+new Date().getTime())})})]})},Tt=async s=>(await ee.post("/api/admin/training/phase4",s)).data,zt=async(s,l)=>{const p=s.map(async(t,r)=>{const u=await fetch(t);if(!u.ok)throw new Error("Failed to fetch provinces");const x=await u.blob();return new File([x],l[r],{type:x.type})});return Promise.all(p)};function Mt({organizer:s,organizersData:l,NextButton:p,PrevButton:t,obtainData:r}){const{toast:u}=ne(),x=K().props.csrf_token,[n,d]=f.useState([]),[i,m]=f.useState([]);f.useEffect(()=>{if(l.length<1)return;let a=[];const c=[];l.map(j=>{c.push(j.id)}),s.map(j=>{c.some(g=>g==j.id)&&a.push(j)}),l.map(async j=>{const g=await zt(j.files.map(T=>T.url),j.files.map(T=>T.files));if(!g||(g==null?void 0:g.length)<1)return;const _=g.map((T,V)=>({user_id:j.id,content:T,type:j.files[V].file_type}));m(_)}),d(a)},[]);const{data:y,isLoading:v,error:b}=le(l.flatMap(a=>a.files.map(c=>c.url)),"docsData",l.flatMap(a=>a.files.map(c=>c.files)));f.useEffect(()=>{if(!y||y.length<1)return;const a=y.map(c=>{const j=l.find(_=>_.files.find(T=>T.files===c.name));if(!j)return;const g=c.name.split("_")[1];return{content:c,type:g,user_id:j.id}});a.some(c=>!c)||m(a)},[y]);const S=a=>{d(a)},h=async()=>{const a=new FormData,c=[];i.map((g,_)=>{c.some(T=>T===g.user_id)||a.append(`content[${_}][users_id]`,g.user_id),c.some(T=>T===g.user_id)?(a.append(`content[${_-1}][files][${_}]`,g.content),a.append(`content[${_-1}][file_type][${_}]`,g.type)):(a.append(`content[${_}][files][${_}]`,g.content),a.append(`content[${_}][file_type][${_}]`,g.type)),c.push(g.user_id)}),a.append("_token",x);const j=await Tt(a);if(j.success){u({title:"Berhasil",description:j.message,variant:"default",duration:5e3});const g=j.data.organizer_data.map((_,T)=>({id:_.users_id,files:_.files.map(J=>({files:J,type:_.file_type[T],url:_.url[T]}))}));r(g),p()}else u({title:"Gagal",description:j.message,variant:"destructive",duration:5e3}),console.error("Error: ",j.data)},o=a=>{m(a)};return e.jsxs(te,{value:"penyelenggara",className:"w-full px-3 py-1",children:[e.jsx("h4",{className:"text-lg font-bold",children:"Penyelenggara"}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(St,{selectedTargets:n,trainingTargets:s,callback:S}),n.length>0&&e.jsx(kt,{selected:n,obtainValue:o,storedData:i})]}),e.jsxs("div",{className:"col-span-full flex justify-between mt-2",children:[e.jsx(B,{type:"button",className:"w-fit justify-start text-left font-normal bg-slate-500 text-white",onClick:()=>t(),children:"< Kembali"}),e.jsx(B,{type:"button",className:"w-fit justify-start text-left font-normal bg-slate-500 text-white",onClick:h,children:"Lanjutkan >"})]})]})}function Dt({facilitator:s,storedData:l,NextButton:p,PrevButton:t,obtainData:r}){const[u,x]=f.useState([]),[n,d]=f.useState([]),i=K().props.csrf_token,{data:m,isLoading:y,error:v}=le(l.flatMap(o=>o.files.map(a=>a.url)),"facsData",l.flatMap(o=>o.files.map(a=>a.files)));f.useEffect(()=>{if(l.length<1)return;let o=[];const a=[];l.map(c=>{a.push(c.id)}),s.map(c=>{a.some(j=>j==c.id)&&o.push(c)}),x(o)},[]),f.useEffect(()=>{if(!m||m.length<1)return;const o=m.map(a=>{const c=l.find(g=>g.files.find(_=>_.files===a.name));if(!c)return;const j=a.name.split("_")[1];return{content:a,type:j,user_id:c.id}});o.some(a=>!a)||d(o)},[m]);const b=o=>{x(o)},S=async()=>{const o=new FormData,a=[];n.map((j,g)=>{a.some(_=>_===j.user_id)||o.append(`content[${g}][users_id]`,j.user_id),a.some(_=>_===j.user_id)?(o.append(`content[${g-1}][files][${g}]`,j.content),o.append(`content[${g-1}][file_type][${g}]`,j.type)):(o.append(`content[${g}][files][${g}]`,j.content),o.append(`content[${g}][file_type][${g}]`,j.type)),a.push(j.user_id)}),o.append("_token",i);const c=await Te(o,5);if(c.success){X({title:"Berhasil",description:c.message,variant:"default",duration:5e3});const j=c.data.facilitator.map((g,_)=>({id:g.users_id,files:g.files.map(V=>({files:V,type:g.file_type[_],url:g.url[_]}))}));r(j),p()}else X({title:"Gagal",description:c.message,variant:"destructive",duration:5e3}),console.error("Error: ",c.data)},h=o=>{d(o)};return e.jsxs(re,{value:"fasilitator",className:"w-full px-3 py-1",children:[e.jsx("h4",{className:"text-lg font-bold",children:"Fasilitator"}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(Ce,{selectedTargets:u,trainingTargets:s,callback:b}),u.length>0&&e.jsx(ke,{selected:u,obtainValue:h,storedData:n})]}),e.jsxs("div",{className:"col-span-full flex justify-between mt-2",children:[e.jsx(B,{type:"button",className:"w-fit justify-start text-left font-normal bg-slate-500 text-white",onClick:()=>t(),children:"< Kembali"}),e.jsx(B,{type:"button",className:"w-fit justify-start text-left font-normal bg-slate-500 text-white",onClick:S,children:"Lanjutkan >"})]})]})}function Bt({controller:s,storedData:l,NextButton:p,PrevButton:t,obtainData:r}){const[u,x]=f.useState([]),[n,d]=f.useState([]),i=K().props.csrf_token,{data:m,isLoading:y,error:v}=le(l.flatMap(o=>o.files.map(a=>a.url)),"contsData",l.flatMap(o=>o.files.map(a=>a.files)));f.useEffect(()=>{if(l.length<1)return;let o=[];const a=[];l.map(c=>{a.push(c.id)}),s.map(c=>{a.some(j=>j==c.id)&&o.push(c)}),x(o)},[]),f.useEffect(()=>{if(!m||m.length<1)return;const o=m.map(a=>{const c=l.find(g=>g.files.find(_=>_.files===a.name));if(!c)return;const j=a.name.split("_")[1];return{content:a,type:j,user_id:c.id}});o.some(a=>!a)||d(o)},[m]);const b=o=>{x(o)},S=async()=>{const o=new FormData,a=[];n.map((j,g)=>{a.some(_=>_===j.user_id)||o.append(`content[${g}][users_id]`,j.user_id),a.some(_=>_===j.user_id)?(o.append(`content[${g-1}][files][${g}]`,j.content),o.append(`content[${g-1}][file_type][${g}]`,j.type)):(o.append(`content[${g}][files][${g}]`,j.content),o.append(`content[${g}][file_type][${g}]`,j.type)),a.push(j.user_id)}),o.append("_token",i);const c=await Te(o,6);if(c.success){X({title:"Berhasil",description:c.message,variant:"default",duration:5e3});const j=c.data.controller.map((g,_)=>({id:g.users_id,files:g.files.map(V=>({files:V,type:g.file_type[_],url:g.url[_]}))}));r(j),p()}else X({title:"Gagal",description:c.message,variant:"destructive",duration:5e3}),console.error("Error: ",c.data)},h=o=>{d(o)};return e.jsxs(re,{value:"pengendali",className:"w-full px-3 py-1",children:[e.jsx("h4",{className:"text-lg font-bold",children:"Pengendali"}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(Ce,{selectedTargets:u,trainingTargets:s,callback:b}),u.length>0&&e.jsx(ke,{selected:u,obtainValue:h,storedData:n})]}),e.jsxs("div",{className:"col-span-full flex justify-between mt-2",children:[e.jsx(B,{type:"button",className:"w-fit justify-start text-left font-normal bg-slate-500 text-white",onClick:()=>t(),children:"< Kembali"}),e.jsx(B,{type:"button",className:"w-fit justify-start text-left font-normal bg-slate-500 text-white",onClick:S,children:"Lanjutkan >"})]})]})}k.object({content:k.string().min(1,"Input tidak boleh kosong")});const Ft=s=>{const{tooltip:l,svg:p,currentState:t}=s,r=t?"Selesai":"Belum selesai",u=t?"border-4 border-primary":"",x=t?"fill-primary":"fill-slate-500";return e.jsx(de,{className:`${u}`,children:e.jsxs(De,{children:[e.jsx(Be,{children:l}),e.jsx(Qe,{className:t?"text-primary font-semibold":"",children:r}),e.jsx("div",{className:"flex justify-center items-center",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:`w-1/4 h-1/4 ${x}`,children:p})})]})})};function Pt({SubmitTraining:s,PrevButton:l,phaseCategory:p}){const[t,r]=f.useState([]),[u,x]=f.useState(!1);f.useEffect(()=>{console.log("variables",t)},[t]),f.useEffect(()=>{console.log("canSubmit",u)},[u]),f.useEffect(()=>{const d=p.map(i=>i.currentState);d.pop(),x(d.every(i=>i===!0))},[]);const n=()=>{s()};return e.jsxs(te,{value:"summarize",className:"w-full px-3 py-1",children:[e.jsx("h4",{className:"text-lg font-bold",children:"Evaluasi"}),e.jsx("div",{className:"flex flex-col gap-3",children:e.jsx("div",{className:"grid    grid-cols-2 gap-2",children:p.map((d,i)=>d.name!=="summarize"&&e.jsx(Ft,{...d},new Date().getTime()+i))})}),e.jsxs("div",{className:"col-span-full flex justify-between mt-2",children:[e.jsx(B,{type:"button",className:"w-fit justify-start text-left font-normal bg-slate-500 text-white",onClick:()=>l(),children:"< Kembali"}),e.jsxs(B,{type:"button",className:"w-fit justify-start text-left gap-2 font-normal bg-primary disabled:bg-blue-300 text-white",onClick:n,disabled:!u,children:["Kirim",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"w-5 h-5 fill-primary-foreground",children:e.jsx("path",{d:"M20.56 3.34a1 1 0 0 0-1-.08l-17 8a1 1 0 0 0-.57.92 1 1 0 0 0 .6.9L8 15.45v6.72L13.84 18l4.76 2.08a.93.93 0 0 0 .4.09 1 1 0 0 0 .52-.15 1 1 0 0 0 .48-.79l1-15a1 1 0 0 0-.44-.89zM18.1 17.68l-5.27-2.31L16 9.17l-7.65 4.25-2.93-1.29 13.47-6.34z"})})]})]})]})}const $t=({title:s,trainings:l,facilitator:p,normal_user:t})=>{const[r,u]=f.useState(""),x=n=>{if(r===`accord-item-${n}`){u("");return}u(`accord-item-${n}`)};return e.jsx(it,{type:"single",collapsible:!0,value:r,onValueChange:u,children:e.jsxs(Ne,{children:[e.jsx(ve,{children:e.jsxs(Q,{children:[e.jsx(U,{className:"w-fit",children:"No"}),e.jsx(U,{children:"Nama"}),e.jsx(U,{hidden:!0,children:"Download SPT & SPK"}),e.jsx(U,{hidden:!0,className:"text-right",children:"Upload SPT & SPK"})]})}),e.jsx(Se,{children:l.map((n,d)=>e.jsxs(e.Fragment,{children:[e.jsxs(Q,{children:[e.jsx(O,{className:"font-medium",children:d+1}),e.jsx(O,{children:n.name}),e.jsx(O,{}),e.jsx(O,{className:"text-right",children:e.jsx(B,{className:"bg-blue-500 text-white",onClick:()=>x(n.id),children:e.jsxs("p",{className:"flex gap-2 justify-center align-middle items-center",children:[e.jsx("span",{children:"Detail"}),e.jsxs("svg",{className:"w-6 h-6 fill-primary-foreground",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M12 1.993C6.486 1.994 2 6.48 2 11.994c0 5.513 4.486 9.999 10 10 5.514 0 10-4.486 10-10s-4.485-10-10-10.001zm0 18.001c-4.411-.001-8-3.59-8-8 0-4.411 3.589-8 8-8.001 4.411.001 8 3.59 8 8.001s-3.589 8-8 8z"}),e.jsx("path",{d:"M13 8h-2v4H7.991l4.005 4.005L16 12h-3z"})]})]})})})]},n.name+"_"+n.type+"_"+new Date(n.created_at).getTime()+(d+1+Math.random())),e.jsx(Q,{className:"border-none border-0",children:e.jsx(O,{colSpan:9,className:"border-0 border-none w-full",children:e.jsx(ct,{value:`accord-item-${n.id}`,className:"w-full flex flex-col col-span-full",children:e.jsxs(ot,{children:["Accordion Item ",n.id]})})},d+"_"+n.name+"_"+n.type+"_"+new Date(n.created_at).getTime()+(d+1+Math.random()))})]}))})]})})},It=s=>{const{training_types:l,targets:p,file_types:t,organizer:r,facilitator:u,controller:x,phase_data:n}=s;K().props;let[d,i]=f.useState([{name:"training",tooltip:"Pelatihan",svg:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"w-6 h-6",children:e.jsx("path",{d:"M2 3h2v18H2zm18 0h2v18h-2zM5 13h2v1h2v-1h2v1h2v-1h4v1h2v-4h-2v1h-4v-1h-2v1H9v-1H7v1H5zm0-9v4h2V7h8v1h2V7h2V5h-2V4h-2v1H7V4zm0 13v3h2v-1h2v1h2v-1h8v-2h-8v-1H9v1H7v-1H5z"})}),currentState:!1,disabled:!1},{name:"materi",tooltip:"Materi & Jadwal",svg:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M19 4h-3V2h-2v2h-4V2H8v2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2V6c0-1.103-.897-2-2-2zM5 20V7h14V6l.002 14H5z"}),e.jsx("path",{d:"M7 10v2h10V9H7z"})]}),currentState:!1,disabled:!1},{name:"dokumen",tooltip:"Dokumen",svg:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M12.186 14.552c-.617 0-.977.587-.977 1.373 0 .791.371 1.35.983 1.35.617 0 .971-.588.971-1.374 0-.726-.348-1.349-.977-1.349z"}),e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zM9.155 17.454c-.426.354-1.073.521-1.864.521-.475 0-.81-.03-1.038-.06v-3.971a8.16 8.16 0 0 1 1.235-.083c.768 0 1.266.138 1.655.432.42.312.684.81.684 1.522 0 .775-.282 1.309-.672 1.639zm2.99.546c-1.2 0-1.901-.906-1.901-2.058 0-1.211.773-2.116 1.967-2.116 1.241 0 1.919.929 1.919 2.045-.001 1.325-.805 2.129-1.985 2.129zm4.655-.762c.275 0 .581-.061.762-.132l.138.713c-.168.084-.546.174-1.037.174-1.397 0-2.117-.869-2.117-2.021 0-1.379.983-2.146 2.207-2.146.474 0 .833.096.995.18l-.186.726a1.979 1.979 0 0 0-.768-.15c-.726 0-1.29.438-1.29 1.338 0 .809.48 1.318 1.296 1.318zM14 9h-1V4l5 5h-4z"}),e.jsx("path",{d:"M7.584 14.563c-.203 0-.335.018-.413.036v2.645c.078.018.204.018.317.018.828.006 1.367-.449 1.367-1.415.006-.84-.485-1.284-1.271-1.284z"})]}),currentState:!1,disabled:!1},{name:"penyelenggara",tooltip:"Penyelenggara",svg:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M17.988 22a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h11.988zM9 5h6v2H9V5zm5.25 6.25A2.26 2.26 0 0 1 12 13.501c-1.235 0-2.25-1.015-2.25-2.251S10.765 9 12 9a2.259 2.259 0 0 1 2.25 2.25zM7.5 18.188c0-1.664 2.028-3.375 4.5-3.375s4.5 1.711 4.5 3.375v.563h-9v-.563z"})}),currentState:!1,disabled:!1},{name:"fasilitator",tooltip:"Fasilitator",svg:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M15 11h7v2h-7zm1 4h6v2h-6zm-2-8h8v2h-8zM4 19h10v-1c0-2.757-2.243-5-5-5H7c-2.757 0-5 2.243-5 5v1h2zm4-7c1.995 0 3.5-1.505 3.5-3.5S9.995 5 8 5 4.5 6.505 4.5 8.5 6.005 12 8 12z"})}),currentState:!1,disabled:!1},{name:"pengendali",tooltip:"Pengendali",svg:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M21.986 9.74a3.193 3.193 0 0 0-.008-.088A5.003 5.003 0 0 0 17 5H7a4.97 4.97 0 0 0-4.987 4.737c-.01.079-.013.161-.013.253v6.51c0 .925.373 1.828 1.022 2.476A3.524 3.524 0 0 0 5.5 20c1.8 0 2.504-1 3.5-3 .146-.292.992-2 3-2 1.996 0 2.853 1.707 3 2 1.004 2 1.7 3 3.5 3 .925 0 1.828-.373 2.476-1.022A3.524 3.524 0 0 0 22 16.5V10c0-.095-.004-.18-.014-.26zM7 12.031a2 2 0 1 1-.001-3.999A2 2 0 0 1 7 12.031zm10-5a1 1 0 1 1 0 2 1 1 0 1 1 0-2zm-2 4a1 1 0 1 1 0-2 1 1 0 1 1 0 2zm2 2a1 1 0 1 1 0-2 1 1 0 1 1 0 2zm2-2a1 1 0 1 1 0-2 1 1 0 1 1 0 2z"})}),currentState:!1,disabled:!1},{name:"summarize",tooltip:"Evaluasi",svg:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M20 3H4c-1.103 0-2 .897-2 2v11c0 1.103.897 2 2 2h4l-1.8 2.4 1.6 1.2 2.7-3.6h3l2.7 3.6 1.6-1.2L16 18h4c1.103 0 2-.897 2-2V5c0-1.103-.897-2-2-2zM4 16V5h16l.001 11H4z"}),e.jsx("path",{d:"M6 12h4v2H6z"})]}),currentState:!1,disabled:!1}]),[m,y]=f.useState("training"),[v,b]=f.useState(d);const S=({name:w,tooltip:z,svg:M,disabled:C,currentState:I})=>e.jsx(et,{children:e.jsxs(tt,{children:[e.jsx(st,{asChild:!0,children:e.jsx(oe,{value:w,disabled:C,className:`${m===w?"bg-slate-100 fill-black":"fill-white"}  rounded py-1 px-2 transition-all duration-150 flex flex-col justify-center items-center`,onClick:()=>y(w),children:M})}),e.jsx(at,{className:"bg-white p-1 rounded-md mt-1 shadow-md shadow-slate-500",side:"bottom",children:e.jsx("p",{className:"text-sm text-black",children:z})})]})},w+new Date().getTime()),h=()=>{const w=d.findIndex(M=>M.name===m);if(w===d.length-1||w===-1)return;d[w].currentState=!0;let z=d[w+1];z.currentState=!1,b(d.map(M=>M.name===m?z:M)),y(d[w+1].name)},o=()=>{const w=d.findIndex(z=>z.name===m);w===0||w===-1||y(d[w-1].name)},a=async()=>{const{competences:w,...z}={...g},M={...z,name_competences:w};let C=[];const I=ae.flatMap(E=>{const{files:Y}=E;return C.push(E.id),Y.map(A=>({users_id:E.id,files:A.files,file_type:A.file_type}))}),L=W.flatMap(E=>{const{files:Y}=E;return C.push(E.id),Y.flatMap(A=>({users_id:E.id,files:A.files,file_type:A.file_type}))}),$=H.flatMap(E=>{const{files:Y}=E;return C.push(E.id),Y.flatMap(A=>({users_id:E.id,files:A.files,file_type:A.file_type}))}),pe={...M,files:J,training_schedule:T,training_organizer:C,organizer_data:I,facilitator_data:L,controller_data:$};console.log("body",pe);try{be.post("/admin/training",pe)}catch(E){console.log("error",E)}},[c,j]=f.useState(void 0),[g,_]=f.useState(void 0),[T,V]=f.useState([]),[J,se]=f.useState([]),[ae,Z]=f.useState([]),[W,N]=f.useState([]),[H,D]=f.useState([]),ie=w=>{_(w);const z={from:new Date(w.training_start),to:new Date(w.training_end)};j(z);const M={competences:{name_competences:w.name_competences}},C={trainee_targets:{target_type:w.target_type}},{competences:I,target_type:L,...$}=w;n.phase_1={...M,...C,training:{...$}}},q=w=>{V(w),n.phase_2={schedule:{schedule_content:w}}},Ve=w=>{se(w);const z=w.map(I=>I.files),M=w.map(I=>I.file_type),C={file:{files:z,file_type:M},url:w.map(I=>I.url)};n.phase_3=C},Le=w=>{Z(w),n.phase_4={organizer_data:w}},He=w=>{N(w),console.log("data",w),n.phase_5={facilitator:w}},Oe=w=>{D(w),n.phase_6={controller:w}},G=w=>{if(w===-1)return;const z=d[w];z.currentState=!0;let M=d[w+1];M.currentState=!1,b(d.map(C=>C.name===C.name?M:C))};f.useEffect(()=>{if(n.phase_1){const w=n.phase_1,z={...w.training,competences:w.competences.name_competences,target_type:w.trainee_targets.target_type};_(z),j({from:new Date(w.training.training_start),to:new Date(w.training.training_end)});const M=d.findIndex(C=>C.name==="training");G(M)}if(n.phase_2){const z=[...n.phase_2.schedule.schedule_content];V(z);const M=d.findIndex(C=>C.name==="materi");G(M)}if(n.phase_3){const w=n.phase_3,{file:z,url:M}=w;console.log(z);const C=z.files.map((L,$)=>({file_type:z.file_type[$],files:L,url:M[$]}));se(C);const I=d.findIndex(L=>L.name==="dokumen");G(I)}if(n.phase_4){const z=n.phase_4.organizer_data.map(C=>({id:parseInt(C.users_id),files:C.files.map((L,$)=>({files:L,file_type:C.file_type[$],url:C.url[$]}))}));Z(z);const M=d.findIndex(C=>C.name==="penyelenggara");G(M)}if(n.phase_5){const z=n.phase_5.facilitator.map(C=>({id:parseInt(C.users_id),files:C.files.map((L,$)=>({files:L,file_type:C.file_type[$],url:C.url[$]}))}));N(z);const M=d.findIndex(C=>C.name==="fasilitator");G(M)}if(n.phase_6){const z=n.phase_6.controller.map(C=>({id:parseInt(C.users_id),files:C.files.map((L,$)=>({files:L,file_type:C.file_type[$],url:C.url[$]}))}));D(z);const M=d.findIndex(C=>C.name==="pengendali");G(M)}},[]);const Re=w=>{const z=d.findIndex(M=>M.name===w);if(z!==0&&d[z-1].currentState===!1)return e.jsx("p",{className:"text-center text-lg py-4",children:"Silahkan selesaikan tahap sebelum melanjutkan"});if(m==="training")return e.jsx(xt,{NextButton:h,handleTrainingSubmit:ie,trainingData:g,trainingTargets:p,trainingTypes:l});if(m==="materi"&&c)return e.jsx(jt,{NextButton:h,PrevButton:o,trainingPeriod:c,obtainData:q,scheduleData:T});if(m==="dokumen")return e.jsx(vt,{file_types:t,NextButton:h,PrevButton:o,obtainValue:Ve,fileData:J});if(m==="penyelenggara")return e.jsx(Mt,{organizer:r,organizersData:ae,NextButton:h,PrevButton:o,obtainData:Le});if(m==="fasilitator")return e.jsx(Dt,{facilitator:u,storedData:W,NextButton:h,PrevButton:o,obtainData:He});if(m==="pengendali")return e.jsx(Bt,{controller:x,storedData:H,NextButton:h,PrevButton:o,obtainData:Oe});if(m==="summarize")return e.jsx(Pt,{SubmitTraining:a,PrevButton:o,phaseCategory:d})};return e.jsx(re,{value:"newTR",children:e.jsx(de,{className:"w-full pt-2 pb-1 px-2",children:e.jsxs(ze,{defaultValue:m,value:m,onValueChange:y,className:"w-full",children:[e.jsx(Me,{className:"grid w-full gap-1 grid-cols-7 bg-primary text-white mb-4 p-2 mx-auto rounded-lg transition-all duration-150",children:d.map(w=>f.createElement(S,{...w,key:new Date().getTime()%Math.random()}))}),Re(m)]})})})},Et=s=>e.jsx(re,{value:"organizeTR",children:e.jsxs(de,{children:[e.jsx(De,{children:e.jsx(Be,{children:"Daftar Pelatihan"})}),e.jsx(Xe,{children:e.jsx($t,{...s})})]})}),Vt=s=>{const l="organizeTR";let[p,t]=f.useState(l);return e.jsxs(ze,{defaultValue:l,className:"w-full",children:[e.jsxs(Me,{className:"grid w-2/3 gap-2 grid-cols-2 bg-primary text-white mb-4 p-2 mx-auto rounded-lg transition-all duration-150",children:[e.jsx(oe,{value:"newTR",className:`${p==="newTR"?"bg-slate-100 text-black":""} rounded py-1 px-2 transition-all duration-150`,onClick:()=>t("newTR"),children:"Tambah Pelatihan"}),e.jsx(oe,{value:"organizeTR",className:`${p==="organizeTR"?"bg-slate-100 text-black":""} rounded py-1 px-2 transition-all duration-150`,onClick:()=>t("organizeTR"),children:"Kelola Pelatihan"})]}),e.jsx(It,{...s}),e.jsx(Et,{...s})]})};function Yt(s){const l=K().props;return f.useEffect(()=>{if(console.log("originalProps",l),Object.keys(l.errors).length>0){const p=l.errors;Object.keys(p).map(t=>{X({title:"Error",description:p[t],variant:"destructive",duration:5e3})})}},[l]),e.jsxs(e.Fragment,{children:[e.jsx(Ke,{title:"Pelatihan"}),e.jsx("div",{className:"flex flex-col items-center justify-center gap-5 p-5",children:e.jsx(Vt,{...s})})]})}export{Yt as default};
